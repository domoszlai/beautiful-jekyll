(this.webpackJsonpmealee=this.webpackJsonpmealee||[]).push([[0],{124:function(e,t,a){e.exports=a(153)},125:function(e,t,a){},144:function(e,t){},145:function(e,t){},153:function(e,t,a){"use strict";a.r(t);a(125);var n=a(0),r=a.n(n),i=a(14),o=a.n(i),l=a(12),c=a(18),s=a(118),u=a(116),m=a(164),p=a(166),d=a(99),g=a(179),f=a(161),h=a(187),v=a(188),E=a(9),y=a(98),b=function(e){var t=e.title,a=e.loadButtonTitle,n=e.onClose,i=e.onLoad,o=r.a.useState(null),l=Object(E.a)(o,2),c=l[0],s=l[1];return r.a.createElement(h.a,{show:!0,onHide:n},r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,t)),r.a.createElement(h.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(y.a,{type:"file",onChange:function(e){e.target.files?s(e.target.files[0]):s(null)}}))),r.a.createElement(h.a.Footer,null,r.a.createElement(f.a,{type:"button",variant:"secondary",onClick:n},"Close"),r.a.createElement(f.a,{type:"button",variant:"primary",disabled:!c,onClick:function(){c&&i(c)}},a)))},S=a(100),k=a.n(S),w=function(e){var t=e.title,a=e.saveButtonTitle,n=e.onClose,i=e.onSave,o=e.data,l=e.type,c=e.initialFileName,s=e.extension,u=r.a.useState(c),m=Object(E.a)(u,2),p=m[0],d=m[1];return r.a.createElement(h.a,{show:!0,onHide:n},r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,t)),r.a.createElement(h.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(v.a.Group,{controlId:"formBasicFileName"},r.a.createElement(v.a.Label,null,"File name"),r.a.createElement(v.a.Control,{type:"fileName",value:p,onChange:function(e){return d(e.target.value)}})))),r.a.createElement(h.a.Footer,null,r.a.createElement(f.a,{type:"button",variant:"secondary",onClick:n},"Close"),r.a.createElement(f.a,{type:"button",variant:"primary",disabled:!p||0===p.length,onClick:function(){k()(o,p+"."+s,l),i()}},a)))},N=a(194),O=a(163),C=a(165),I=a(162),x=function(){function e(t,a){Object(l.a)(this,e),this.name=void 0,this.script=void 0,this.name=t,this.script=a}return Object(c.a)(e,[{key:"toJSON",value:function(){return{name:this.name,script:this.script}}},{key:"getName",value:function(){return this.name}},{key:"getScript",value:function(){return this.script}}],[{key:"fromJSON",value:function(t){if(!t.name)throw new Error("Missing name field");if(!t.script)throw new Error("Missing script field");return new e(t.name,t.script)}}]),e}(),j=function(){function e(t){Object(l.a)(this,e),this.json=void 0,this.json=t?t.toJSON():{}}return Object(c.a)(e,[{key:"buckets",value:function(e){return this.json.nrBuckets=e,this}},{key:"scoringFuns",value:function(e){return this.json.scoringFuns=e,this}},{key:"build",value:function(){return F.fromJSON(this.json)}}]),e}(),F=function(){function e(){Object(l.a)(this,e),this.nrBuckets=void 0,this.scoringFuns=void 0,this.nrBuckets=7,this.scoringFuns=[]}return Object(c.a)(e,[{key:"toJSON",value:function(){return{nrBuckets:this.nrBuckets,scoringFuns:this.scoringFuns.map((function(e){return e.toJSON()}))}}},{key:"getNrBuckets",value:function(){return this.nrBuckets}},{key:"getScoringFuns",value:function(){return this.scoringFuns}}],[{key:"builder",value:function(e){return new j(e)}},{key:"fromJSON",value:function(t){if(t.nrBuckets||(t.nrBuckets=7),t.nrBuckets<1||t.nrBuckets>7)throw new Error("Wrong number of recipes");t.scoringFuns||(t.scoringFuns=[]);var a=new e;return a.nrBuckets=t.nrBuckets,a.scoringFuns=t.scoringFuns.map((function(e){return x.fromJSON(e)})),a}}]),e}(),R=a(8),B=a.n(R),L=function(e){var t=r.a.useState(!1),a=Object(E.a)(t,2),n=a[0],i=a[1],o=r.a.useState(e.settings.toJSON()),l=Object(E.a)(o,2),c=l[0],s=l[1],u=function(e){return c.scoringFuns[e].name.trim().length>0},p=function(e){return c.scoringFuns[e].script.trim().length>0},d=c.scoringFuns.map((function(e,t){return r.a.createElement("tr",null,r.a.createElement("td",{style:{width:150}},r.a.createElement(v.a.Control,{isInvalid:!u(t),className:"mealee-table-edit",type:"name",size:"sm",value:e.name,onChange:function(e){return function(e,t){var a=Object.assign({},c);a.scoringFuns[e].name=t,s(a),i(!0)}(t,e.currentTarget.value)}})),r.a.createElement("td",null,r.a.createElement(v.a.Control,{isInvalid:!p(t),rows:p(t)?e.script.split(/\r\n|\r|\n/).length+1:1,as:"textarea",className:"mealee-table-edit",type:"name",size:"sm",style:{height:"100%"},value:e.script,onChange:function(e){return function(e,t){var a=Object.assign({},c);a.scoringFuns[e].script=t,s(a),i(!0)}(t,e.currentTarget.value)}})),r.a.createElement("td",{style:{width:30}},r.a.createElement(I.a,{onClick:function(){return function(e){var t=Object.assign({},c);t.scoringFuns=B.a.concat(B.a.take(t.scoringFuns,e),B.a.drop(t.scoringFuns,e+1)),s(t),i(!0)}(t)},style:{cursor:"pointer"}})))}));return r.a.createElement(h.a,{show:!0,onHide:e.onClose,dialogClassName:"mealee-settings-dialog"},r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Settings")),r.a.createElement(h.a.Body,{style:{width:800}},r.a.createElement(N.a,{defaultActiveKey:"general"},r.a.createElement(O.a,{eventKey:"general",title:"General"},r.a.createElement(m.a,{className:"p-3"},r.a.createElement(v.a,{onSubmit:function(e){return e.preventDefault()}},r.a.createElement(v.a.Group,{controlId:"nrRecipes"},r.a.createElement(v.a.Label,null,"Number of recipes:"),r.a.createElement(v.a.Control,{as:"select",value:c.nrBuckets,onChange:function(e){return function(e){var t=Object.assign({},c);t.nrBuckets=e,s(t),i(!0)}(parseInt(e.target.value))}},r.a.createElement("option",{key:"3"},"3"),r.a.createElement("option",{key:"4"},"4"),r.a.createElement("option",{key:"5"},"5"),r.a.createElement("option",{key:"6"},"6"),r.a.createElement("option",{key:"7"},"7")))))),r.a.createElement(O.a,{eventKey:"scoring",title:"Scoring",className:"h-100"},r.a.createElement(m.a,{className:"p-3 h-100 d-flex flex-column"},r.a.createElement(v.a,{onSubmit:function(e){return e.preventDefault()},className:"h-100 d-grow-1"},r.a.createElement("div",{className:"p-0 tableFixHead"},r.a.createElement(C.a,{hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Expression"),r.a.createElement("th",{className:"m-0 p-0",style:{width:0}},"\xa0"))),r.a.createElement("tbody",null,d))),r.a.createElement(f.a,{onClick:function(){var e=Object.assign({},c);e.scoringFuns=e.scoringFuns.concat([{name:"new scoring fun",script:"random(1)"}]),s(e),i(!0)}},"Add scoring function")))))),r.a.createElement(h.a.Footer,null,r.a.createElement(f.a,{type:"button",variant:"primary",onClick:function(){e.onSave(F.fromJSON(c))},disabled:!n},"Save"),r.a.createElement(f.a,{type:"button",variant:"secondary",onClick:e.onClose},"Close")))},D=a(19),T=a(113),A=function(){function e(t,a,n){Object(l.a)(this,e),this.name=void 0,this.amount=void 0,this.unit=void 0,this.name=t,this.amount=a,this.unit=n}return Object(c.a)(e,[{key:"getName",value:function(){return this.name}},{key:"getAmount",value:function(){return this.amount}},{key:"getUnit",value:function(){return this.unit}},{key:"toJSON",value:function(){return{name:this.name,amount:this.amount,unit:this.unit}}}],[{key:"fromJSON",value:function(t){if(!t.name)throw new Error("Missing ingredient name");if(!t.unit)throw new Error("Missing ingredient unit");if(void 0===t.amount)throw new Error("Missing ingredient amount");return new e(t.name,t.amount,t.unit)}}]),e}();var M=function(){function e(t,a){Object(l.a)(this,e),this.id=void 0,this.title=void 0,this.comment=void 0,this.source=void 0,this.serving=void 0,this.ingredients=void 0,this.labels=void 0,this.id=t,this.title=a,this.ingredients=[],this.labels=[],this.serving=4}return Object(c.a)(e,[{key:"getId",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getComment",value:function(){return this.comment}},{key:"getSource",value:function(){return this.source}},{key:"getServing",value:function(){return this.serving}},{key:"getIngredients",value:function(){return this.ingredients}},{key:"getLabels",value:function(){return this.labels}},{key:"toJSON",value:function(){return{id:this.id,title:this.title,comment:this.comment,source:this.source,serving:this.serving,ingredients:this.ingredients.map((function(e){return e.toJSON()})),labels:this.labels}}}],[{key:"fromJSON",value:function(t){var a,n;if(t.id||(t.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))),!t.title)throw new Error("Missing recipe title");var r=new e(t.id,t.title);return r.comment=t.comment,r.source=t.source,r.serving=null!==(a=t.serving)&&void 0!==a?a:4,r.labels=null!==(n=t.labels)&&void 0!==n?n:[],Array.isArray(t.ingredients)&&(r.ingredients=t.ingredients.map((function(e){return A.fromJSON(e)}))),r}}]),e}();M.error=new M("error","Recipe cannot be found");var P=a(42),U=a(104),z=a(29),J=function e(t,a){var n=this;Object(l.a)(this,e),this.recipesMap=void 0,this.index=void 0,this.fieldAccessors=[function(e){return e.getTitle()},function(e){var t;return null!==(t=e.getComment())&&void 0!==t?t:""},function(e){var t;return null!==(t=e.getSource())&&void 0!==t?t:""},function(e){return e.getIngredients().map((function(e){return e.getName()})).join(" ")},function(e){return e.getLabels().join(" ")}],this.fieldBoostFactors=[2,1,1,1,2],this.termFilter=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},this.add=function(t){var a=t.getId(),r=!0;if(n.recipesMap.has(a)&&JSON.stringify(n.recipesMap.get(a))===JSON.stringify(t)&&(r=!1),r){n.delete(a);var i=n.recipesMap.set(a,t);return Object(P.a)(n.index,n.fieldAccessors,R.words,n.termFilter,a,t),new e(n.index,i)}return n},this.addAll=function(e){return e.reduce((function(e,t){return e.add(t)}),n)},this.search=function(e){return Object(U.a)(n.index,n.fieldBoostFactors,1.2,.75,R.words,n.termFilter,void 0,e).reduce((function(e,t){var a=n.recipesMap.get(t.key);return a&&e.push({key:a,score:t.score}),e}),[])},this.all=function(){return Array.from(n.recipesMap.values())},this.get=function(e){return n.recipesMap.get(e)},this.delete=function(t){if(n.recipesMap.has(t)){var a=n.recipesMap.delete(t);return Object(P.d)(n.index,new Set,t),new e(n.index,a)}return n},this.getAll=function(e){return e.reduce((function(e,t){var a=n.recipesMap.get(t);return a?e.push(a):e.push(M.error),e}),[])},this.count=function(){return n.recipesMap.size},this.index=t||Object(P.b)(this.fieldAccessors.length),this.recipesMap=a||Object(z.b)({})};J.new=function(){return new J},J.prototype.getIngredients=function(){var e=new Set;this.all().forEach((function(t){t.getIngredients().forEach((function(t){e.add(t.getName().toLowerCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)},J.prototype.getUnits=function(){var e=new Set;this.all().forEach((function(t){t.getIngredients().forEach((function(t){e.add(t.getUnit().toLowerCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)},J.prototype.getLabels=function(){var e=new Set;this.all().forEach((function(t){t.getLabels().forEach((function(t){e.add(t.toUpperCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)};var _=a(15),H=a.n(_);a(134),a(135),a(136),a(137),a(91),a(138),a(139);function G(e,t){for(var a=[],n=e.split(/\r?\n/),r=0;r<n.length;r++){var i=n[r];if(i.trim().length>0){var o=i.split(";");if(o.length<3)t.push({from:H.a.Pos(r,0),to:H.a.Pos(r,i.length),message:"Not enough parts. Syntax: <name>;<amount>;<unit>"});else if(o.length>3){var l=o[0].length+o[1].length+o[2].length+2;t.push({from:H.a.Pos(r,l),to:H.a.Pos(r,i.length),message:"Too many parts. Syntax: <name>;<amount>;<unit>"})}else{var c=o[0].length+1,s=c+o[1].length;0===(o=o.map((function(e){return e.trim()})))[0].length||0===o[1].length||0===o[2].length?t.push({from:H.a.Pos(r,0),to:H.a.Pos(r,i.length),message:"Empty part(s). Syntax: <name>;<amount>;<unit>"}):""+Number.parseFloat(o[1])!==o[1]?t.push({from:H.a.Pos(r,c),to:H.a.Pos(r,s),message:"Amount should be a number."}):a.push({name:o[0],amount:Number.parseFloat(o[1]),unit:o[2]})}}}return a}function q(e,t){return function(a){var n=a.getCursor(),r=a.getLine(n.line),i=n.ch,o=n.ch,l=(r.substring(0,o).match(/;/g)||[]).length;if(0!==l&&2!==l)return null;for(;i&&";"!==r.charAt(i-1);)--i;for(;o<r.length&&";"!==r.charAt(o);)++o;var c=r.slice(i,o).trimLeft().toLowerCase(),s=0===l?e.filter((function(e){return e.indexOf(c)>=0})):t.filter((function(e){return e.startsWith(c)}));return 1===s.length&&s[0]===c&&(s=[]),{list:s,from:H.a.Pos(n.line,i),to:H.a.Pos(n.line,o)}}}H.a.defineMode("ingredients",(function(){var e=0,t=1,a=2,n=3;return{startState:function(){return{location:e}},token:function(r,i){r.sol()&&(i.location=e);var o=r.next();return";"===o&&(i.location===e?i.location=t:i.location===t?i.location=a:i.location=n),i.location===n?"error":";"===o?"keyword":i.location===e?(r.eatWhile((function(e){return";"!==e})),"atom"):i.location===t?(r.eatWhile((function(e){return";"!==e})),"number"):i.location===a?(r.eatWhile((function(e){return";"!==e})),"atom"):"error"}}})),H.a.registerHelper("lint","ingredients",(function(e){var t=[];return G(e,t),t}));var W=function(e){var t=r.a.useState(e.recipe?e.recipe.toJSON():Object.create({})),a=Object(E.a)(t,2),n=a[0],i=a[1],o=r.a.useState(!e.recipe),l=Object(E.a)(o,2),c=l[0],s=l[1],u=r.a.useState(!1),m=Object(E.a)(u,2),p=m[0],d=m[1],g=r.a.useState(e.recipe?e.recipe.getIngredients().map((function(e){return e.getName()+";"+e.getAmount()+";"+e.getUnit()})).join("\n"):""),y=Object(E.a)(g,2),b=y[0],S=y[1],k=e.recipeStore.getLabels().map((function(e){return{value:e,label:e}})),w=n.labels?n.labels.map((function(e){return{value:e.toUpperCase(),label:e.toUpperCase()}})):[],N=r.a.createRef(),O=r.a.createRef();return r.a.createElement(h.a,{show:!0,onHide:e.onClose,onEntered:function(){if(N.current&&N.current.focus(),O.current){var t=H.a.fromTextArea(O.current,{lineNumbers:!1,mode:"ingredients",gutters:["CodeMirror-lint-markers"],lint:!0,extraKeys:{"Ctrl-Space":"autocomplete"}});t.on("change",(function(e){!function(e){S(e);var t=[],a=G(e,t);t.length>0?d(!0):(d(!1),i((function(e){return Object(D.a)(Object(D.a)({},e),{ingredients:a})})))}(e.getValue())})),t.on("cursorActivity",(function(t){t.showHint({hint:q(e.recipeStore.getIngredients(),e.recipeStore.getUnits()),completeSingle:!1,closeOnUnfocus:!0})}))}}},r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,e.recipe?"Edit":"Add new "," recipe")),r.a.createElement(h.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(v.a.Group,{controlId:"formTitle"},r.a.createElement(v.a.Control,{type:"title",value:n.title,placeholder:"Title",isInvalid:c,onChange:function(e){var t=e.currentTarget.value;s(!t||0===t.length),i((function(e){return Object(D.a)(Object(D.a)({},e),{title:t})}))},ref:N,size:"sm"}),r.a.createElement(v.a.Control.Feedback,{type:"invalid"},"Required field!")),r.a.createElement(v.a.Group,{controlId:"formComment"},r.a.createElement(v.a.Control,{as:"textarea",value:n.comment,onChange:function(e){var t=e.currentTarget.value;i((function(e){return Object(D.a)(Object(D.a)({},e),{comment:t})}))},rows:2,placeholder:"Comment",size:"sm"})),r.a.createElement(v.a.Group,{controlId:"formSource"},r.a.createElement(v.a.Control,{type:"source",value:n.source,onChange:function(e){var t=e.currentTarget.value;i((function(e){return Object(D.a)(Object(D.a)({},e),{source:t})}))},placeholder:"Where to find the recipe",size:"sm"})),r.a.createElement(v.a.Group,{controlId:"formServing"},r.a.createElement(v.a.Control,{type:"serving",value:n.serving,onChange:function(e){var t=Number.parseInt(e.currentTarget.value);isNaN(t)&&(t=void 0),i((function(e){return Object(D.a)(Object(D.a)({},e),{serving:t})}))},placeholder:"Number of porties",size:"sm"})),r.a.createElement(v.a.Group,{controlId:"formLabel"},r.a.createElement(T.a,{styles:{menu:function(e){return Object(D.a)(Object(D.a)({},e),{},{zIndex:9999})}},size:"sm",options:k,isMulti:!0,placeholder:"Labels",onChange:function(e){var t=e.map((function(e){return e.label}));i((function(e){return Object(D.a)(Object(D.a)({},e),{labels:t})}))},value:w})),r.a.createElement(v.a.Group,{controlId:"formIngredients"},r.a.createElement(v.a.Control,{as:"textarea",value:b,ref:O,placeholder:"Ingredients: <name>;<amount>;<unit>"})))),r.a.createElement(h.a.Footer,null,r.a.createElement(f.a,{type:"button",variant:"secondary",onClick:e.onClose},"Close"),r.a.createElement(f.a,{type:"button",variant:"primary",onClick:function(){e.onSave(M.fromJSON(n))},disabled:c||p},"Save recipe"),e.recipe&&r.a.createElement(f.a,{type:"button",variant:"primary",onClick:function(){e.recipe&&e.onDelete(e.recipe)}},"Delete recipe")))},V=a(17),X=function(){function e(t,a){Object(l.a)(this,e),this.recipeId=void 0,this.serving=void 0,this.recipeId=t,this.serving=a}return Object(c.a)(e,[{key:"getRecipeId",value:function(){return this.recipeId}},{key:"getServing",value:function(){return this.serving}}]),e}(),K=function(){function e(t){Object(l.a)(this,e),this.buckets=Object(z.a)(),this.buckets=t}return Object(c.a)(e,[{key:"setNrBuckets",value:function(t){return new e(this.buckets.setSize(t))}},{key:"getNrBuckets",value:function(){return this.buckets.size}},{key:"getNrRecipes",value:function(){var e,t=0,a=Object(V.a)(this.buckets);try{for(a.s();!(e=a.n()).done;){var n=e.value;n&&(t+=n.size)}}catch(r){a.e(r)}finally{a.f()}return t}},{key:"setPlannedRecipe",value:function(t,a){var n,r=null!==(n=this.buckets.get(t))&&void 0!==n?n:Object(z.b)();return new e(this.buckets.set(t,r.set(a.getRecipeId(),a)))}},{key:"deleteRecipeById",value:function(t,a){var n,r=null!==(n=this.buckets.get(t))&&void 0!==n?n:Object(z.b)();return new e(this.buckets.set(t,r.delete(a)))}},{key:"getPlannedRecipes",value:function(e){var t,a=null!==(t=this.buckets.get(e))&&void 0!==t?t:Object(z.b)();return Array.from(a.valueSeq())}},{key:"getAllPlannedRecipes",value:function(){var e,t=Object(z.a)(),a=Object(V.a)(this.buckets);try{for(a.s();!(e=a.n()).done;){var n=e.value;n&&(t=t.concat(n.values()))}}catch(r){a.e(r)}finally{a.f()}return Array.from(t)}},{key:"getAllRecipeIds",value:function(){var e,t=Object(z.c)(),a=Object(V.a)(this.buckets);try{for(a.s();!(e=a.n()).done;){var n=e.value;n&&(t=t.concat(n.valueSeq().map((function(e){return e.getRecipeId()}))))}}catch(r){a.e(r)}finally{a.f()}return Array.from(t)}}]),e}();K.new=function(e){return new K(Object(z.a)().setSize(e))};var Y,Q=a(28),Z=a.n(Q);function $(e){var t=new Map;return e.forEach((function(e){var a=e[0],n=e[1];a.getIngredients().forEach((function(e){var r,i=e.getName().toLowerCase(),o=t.get(i);o||(o=new Map,t.set(i,o));var l=null!==(r=o.get(n))&&void 0!==r?r:[];l.push([e.getAmount(),e.getUnit().toLowerCase(),n.getServing()/a.getServing()]),o.set(n,l)}))})),t}function ee(e,t){var a,n=t.map((function(t){var a,n,r=new Map,i=null!==(a=e.get(t))&&void 0!==a?a:new Map,o=Object(V.a)(i.values());try{for(o.s();!(n=o.n()).done;){var l,c=n.value,s=Object(V.a)(c);try{for(s.s();!(l=s.n()).done;){var u,m=Object(E.a)(l.value,3),p=m[0],d=m[1],g=m[2];r.set(d,(null!==(u=r.get(d))&&void 0!==u?u:0)+p*g)}}catch(f){s.e(f)}finally{s.f()}}}catch(f){o.e(f)}finally{o.f()}return{name:t,amounts:r}})),r=[],i=Object(V.a)(n);try{for(i.s();!(a=i.n()).done;){var o,l=a.value,c=l.name,s=l.amounts,u=[c],m=Object(V.a)(s);try{for(m.s();!(o=m.n()).done;){var p=Object(E.a)(o.value,2),d=p[0],g=p[1];u.push(g+" "+d)}}catch(f){m.e(f)}finally{m.f()}r.push(u)}}catch(f){i.e(f)}finally{i.f()}return r}function te(){switch(this.state.showDialog){case Y.LoadFile:return r.a.createElement(b,{onClose:this.closeDialog,title:"Load recipes file",loadButtonTitle:"Load recipes",onLoad:this.loadFile});case Y.SaveFile:return r.a.createElement(w,{onClose:this.closeDialog,title:"Save recipes file",saveButtonTitle:"Save recipes",data:this.genRecipeFileContent(),type:"application/json",initialFileName:"recipes",extension:"json",onSave:this.fileSaved});case Y.RecipeEditor:return r.a.createElement(W,{onClose:this.closeRecipeEditor,onSave:this.saveRecipe,onDelete:this.deleteRecipe,recipe:this.state.recipeToEdit,recipeStore:this.state.recipeStore});case Y.SavePlanXLS:return r.a.createElement(w,{onClose:this.closeDialog,title:"Save plan",saveButtonTitle:"Save plan",data:this.state.plan.export(this.state.recipeStore),type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",initialFileName:"plan",extension:"xlsx",onSave:this.closeDialog});case Y.ShoppingList:return r.a.createElement(h.a,{show:!0,onHide:this.closeDialog},r.a.createElement(h.a.Header,{closeButton:!0},r.a.createElement(h.a.Title,null,"Shopping list")),r.a.createElement(h.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(v.a.Control,{as:"textarea",rows:20,cols:80,value:this.state.plan.exportShoppingList(this.state.recipeStore),readOnly:!0}))),r.a.createElement(h.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:this.closeDialog},"Close")));case Y.PlanSettings:return r.a.createElement(L,{onClose:this.closeDialog,settings:this.state.settings,onSave:this.updateSettings});default:return r.a.createElement(r.a.Fragment,null)}}K.prototype.exportShoppingList=function(e){var t,a=this.getAllPlannedRecipes(),n=e.getAll(a.map((function(e){return e.getRecipeId()}))),r=$(B.a.zip(n,a)),i=new Intl.Collator,o=Array.from(r.keys()).sort(i.compare),l=ee(r,o),c="",s=Object(V.a)(l);try{for(s.s();!(t=s.n()).done;){var u=t.value;c+="**"+u.shift()+"**",c+=" - ",c+=u.join(" + "),c+="\n"}}catch(m){s.e(m)}finally{s.f()}return c},K.prototype.export=function(e){var t=this,a=this.getAllPlannedRecipes(),n=e.getAll(a.map((function(e){return e.getRecipeId()}))),r=B.a.zip(n,a),i=new Set(n),o=$(r),l=Array.from(o.keys()).sort(),c=Z.a.utils.book_new(),s=B.a.range(0,this.getNrBuckets()).map((function(a){var n=t.getPlannedRecipes(a),r=e.getAll(n.map((function(e){return e.getRecipeId()}))),i=B.a.zip(r,n);return["Day #"+(a+1)].concat(i.map((function(e){return e[0].getTitle()+" ("+e[1].getServing()+" people)"})))})),u=Z.a.utils.aoa_to_sheet(s);Z.a.utils.book_append_sheet(c,u,"Plan");var m=ee(o,l),p=Z.a.utils.aoa_to_sheet(m);Z.a.utils.book_append_sheet(c,p,"Shopping list");var d=r.map((function(e){return e[0].getTitle()+" ("+e[1].getServing()+" people)"}));d.unshift("");var g=l.map((function(e){var t,n=[e],r=Object(V.a)(a);try{for(r.s();!(t=r.n()).done;){var i,l=t.value,c=(null!==(i=o.get(e))&&void 0!==i?i:new Map).get(l);c?n.push(c.map((function(e){return e[0]*e[2]+" "+e[1]})).join(", ")):n.push("")}}catch(s){r.e(s)}finally{r.f()}return n})),f=[d].concat(g),h=Z.a.utils.aoa_to_sheet(f);Z.a.utils.book_append_sheet(c,h,"Ingredient map");var v,E=Object(V.a)(i);try{for(E.s();!(v=E.n()).done;){var y,b,S,k=v.value,w=[["Title",k.getTitle()],["Comment",null!==(y=k.getComment())&&void 0!==y?y:"-"],["Serves",k.getServing()],["Source",null!==(b=k.getSource())&&void 0!==b?b:"-"],["Ingredients:"]],N=Object(V.a)(k.getIngredients());try{for(N.s();!(S=N.n()).done;){var O=S.value;w.push([O.getName().toLowerCase(),O.getAmount(),O.getUnit().toLowerCase()])}}catch(j){N.e(j)}finally{N.f()}var C=Z.a.utils.aoa_to_sheet(w),I=k.getTitle().substr(0,31).replace(/[[\]/\\:*?]/g,"_");Z.a.utils.book_append_sheet(c,C,I)}}catch(j){E.e(j)}finally{E.f()}var x=Z.a.write(c,{bookType:"xlsx",bookSST:!1,type:"array"});return new Blob([x],{type:"application/octet-stream"})},function(e){e[e.LoadFile=0]="LoadFile",e[e.SaveFile=1]="SaveFile",e[e.RecipeEditor=2]="RecipeEditor",e[e.SavePlanXLS=3]="SavePlanXLS",e[e.ShoppingList=4]="ShoppingList",e[e.PlanSettings=5]="PlanSettings"}(Y||(Y={}));var ae=a(180),ne=function e(){var t=this;Object(l.a)(this,e),this.scorings=void 0,this.sum=void 0,this.addScoring=function(e,a){t.scorings.set(e,a),t.sum+=a},this.getSum=function(){return t.sum},this.getScorings=function(){return Array.from(t.scorings)},this.scorings=new Map,this.sum=0},re=function e(){var t=this;Object(l.a)(this,e),this.scoring=void 0,this.sum=void 0,this.addScoring=function(e,a,n){var r;t.scoring.has(e)||t.scoring.set(e,new ne),null===(r=t.scoring.get(e))||void 0===r||r.addScoring(a,n)},this.getSum=function(e){var a=t.scoring.get(e);return a?a.getSum():0},this.getScoring=function(e){return t.scoring.get(e)},this.scoring=new Map,this.sum=0},ie=a(105);function oe(e){return B.a.countBy(e.getLabels().map((function(e){return e.toUpperCase()})))}function le(e,t,a){return new Map(t.map((function(t){return[t,e.evaluate({this:t})]})))}J.prototype.scoreBy=function(e,t){var a=new ie.a,n=this.all(),r=new Map(n.map((function(e){return[e,oe(e)]}))),i=e.getAllPlannedRecipes().map((function(e){return e.getRecipeId()})),o=B.a.countBy(i),l=B.a.countBy(B.a.flatMap(this.getAll(i),(function(e){return e.getLabels()})).map((function(e){return e.toUpperCase()})));a.functions.intersection=function(e,t){return B.a.intersection(e,t)},a.functions.sum=function(e){return B.a.sum(e)},a.functions.ingredients=function(e){return e.getIngredients()},a.functions.hasLabel=function(e,t){var a=r.get(e);return!!a&&a[t]>0},a.functions.countLabelInPlan=function(e){var t;return null!==(t=l[e])&&void 0!==t?t:0},a.functions.countRecipeInPlan=function(e){var t;return null!==(t=o[e.getId()])&&void 0!==t?t:0};var c,s=new re,u=Object(V.a)(t);try{var m=function(){var e=c.value,t=a.parse(e.getScript()),r=-1;a.functions.normalize=function(e){return e>r&&(r=e),e};var i=le(t,n);r>0&&(a.functions.normalize=function(e){return e/r},i=le(t,n));var o,l=Object(V.a)(i);try{for(l.s();!(o=l.n()).done;){var u=Object(E.a)(o.value,2),m=u[0],p=u[1];s.addScoring(m.getId(),e,p)}}catch(d){l.e(d)}finally{l.f()}};for(u.s();!(c=u.n()).done;)m()}catch(p){u.e(p)}finally{u.f()}return s};var ce=a(175),se=a(189),ue=a(193),me=a(177),pe=a(195),de=a(196),ge=a(173),fe=a(174),he=a(176),ve=a(178),Ee=a(167),ye=a(168),be=a(169),Se=a(170),ke=a(171),we=a(172),Ne=function(e){var t=e.recipe,a=e.scoring,n=new Intl.Collator,i=t.getIngredients().map((function(e){return e.getName()})).sort(n.compare).map((function(e){return r.a.createElement(d.a,{key:e,sm:"auto",className:"border mt-1 ml-2 pt-2 pb-2"},e)})),o=t.getLabels().sort(n.compare).map((function(e){return r.a.createElement(d.a,{key:e,sm:"auto",className:"border mt-1 ml-2 pt-2 pb-2"},e)})),l=a&&a.getScorings().map((function(e){return r.a.createElement(p.a,{key:e[0].getName()},r.a.createElement(d.a,{xs:"2"},e[1].toFixed(2)),r.a.createElement(d.a,{xs:"1"},"\u2190"),r.a.createElement(d.a,null,e[0].getName()))}));return r.a.createElement(m.a,{className:"pl-0 pr-2"},t.getComment()&&r.a.createElement(p.a,{className:"pb-2"},r.a.createElement(d.a,{sm:"auto"},r.a.createElement(Ee.a,{height:"18"})),r.a.createElement(d.a,{sm:"auto"},t.getComment())),t.getServing()&&r.a.createElement(p.a,{className:"pb-2"},r.a.createElement(d.a,{sm:"auto"},r.a.createElement(ye.a,{height:"18"})),r.a.createElement(d.a,{sm:"auto"},t.getServing())),t.getSource()&&r.a.createElement(p.a,{className:"pb-2"},r.a.createElement(d.a,{sm:"auto"},r.a.createElement(be.a,{height:"18"})),r.a.createElement(d.a,{sm:"auto"},t.getSource())),r.a.createElement(p.a,{className:"pb-2"},r.a.createElement(d.a,{xs:1},r.a.createElement(Se.a,{height:"18"})),r.a.createElement(d.a,null,r.a.createElement(m.a,{fluid:!0,className:"pl-0"},r.a.createElement(p.a,null,i)))),t.getLabels().length>0&&r.a.createElement(p.a,{className:"pb-2"},r.a.createElement(d.a,{xs:1},r.a.createElement(ke.a,{height:"18"})),r.a.createElement(d.a,null,r.a.createElement(m.a,{fluid:!0,className:"pl-0"},r.a.createElement(p.a,null,o)))),a&&r.a.createElement(p.a,null,r.a.createElement(d.a,{xs:1},r.a.createElement(we.a,{height:"18"})),r.a.createElement(d.a,null,r.a.createElement(m.a,{className:"ml-0 pl-0"},l,r.a.createElement(p.a,null,r.a.createElement(d.a,{xs:"2",className:"border"},a.getSum().toFixed(2)))))))},Oe=a(191),Ce=function(e){var t=e.recipe,a=e.selected,n=e.scoring,i=e.onEdit,o=Object(Oe.a)({item:{type:"recipe",id:t.getId()},collect:function(e){return{isDragging:!!e.isDragging()}}}),l=Object(E.a)(o,2),c=l[0].isDragging,s=l[1],u=new Intl.Collator,g=t.getLabels().sort(u.compare).map((function(e){return r.a.createElement(d.a,{key:e,sm:"auto",className:"mealee-recipe-selector-label mt-1 ml-2"},e)}));return r.a.createElement("div",{className:"hover",style:{position:"relative",width:"100%",height:"100%",backgroundColor:"#FFFFFF"}},r.a.createElement(pe.a,{className:"mealee-recipe-selector-item",key:t.getId(),ref:s,style:{opacity:c||a?.5:1,cursor:"move"}},r.a.createElement(pe.a.Body,{className:"p-0"},r.a.createElement(m.a,null,r.a.createElement(p.a,null,r.a.createElement(d.a,{className:"pl-0 ml-2"},t.getTitle())),r.a.createElement(p.a,null,g)))),r.a.createElement("div",{className:"hover-on",style:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:10,height:20,width:40,zIndex:1,opacity:.5}},r.a.createElement(ge.a,{height:"18",onClick:function(){return i(t)},style:{cursor:"pointer"}}),"\xa0",r.a.createElement(se.a,{placement:"auto",overlay:r.a.createElement(ue.a,{id:"popover-recipe-quick-view",className:"recipe-quick-view"},r.a.createElement(ue.a.Title,{as:"h4"},t.getTitle()),r.a.createElement(ue.a.Content,null,r.a.createElement(Ne,{recipe:t,scoring:n})))},r.a.createElement(fe.a,{height:"18",style:{cursor:"pointer"}}))))},Ie=function(e){var t=e.recipeStore,a=e.scoring,n=e.plan,i=e.onEdit,o=r.a.useState(""),l=Object(E.a)(o,2),c=l[0],s=l[1],u=r.a.useCallback(B.a.debounce(s,100),[]),m=0===c.trim().length?t.all():t.search(c).map((function(e){return e.key})),p=new Set(n.getAllRecipeIds()),d=B.a.sortBy(m,(function(e){return-1*a.getSum(e.getId())})).map((function(e){return r.a.createElement(de.a.Item,{className:"p-0",key:e.getId()},r.a.createElement(Ce,{key:e.getId(),recipe:e,scoring:a.getScoring(e.getId()),onEdit:i,selected:p.has(e.getId())}))}));return r.a.createElement(v.a,{className:"pt-2 h-100 d-flex flex-column",onSubmit:function(e){return e.preventDefault()}},r.a.createElement(ce.a,{className:"mb-1"},r.a.createElement(ce.a.Prepend,null,r.a.createElement(ce.a.Text,null,r.a.createElement(he.a,null))),r.a.createElement(y.a,{type:"text",placeholder:"Filter recipes",value:c,onChange:function(e){u(e.currentTarget.value)}}),r.a.createElement(ce.a.Append,null,r.a.createElement(ce.a.Text,{style:{backgroundColor:"white"}},r.a.createElement(se.a,{key:"download",placement:"right",overlay:r.a.createElement(me.a,{id:"clear-search-field"},"Clear search field")},r.a.createElement(ve.a,{style:{cursor:"pointer"},onClick:function(){return s("")}}))))),r.a.createElement(v.a.Group,{controlId:"recipeGroup",className:"flex-grow-1 overflow-auto mealee-recipe-selector-list"},r.a.createElement(de.a,null,d)))},xe=a(192),je=function(e){var t,a=e.bucketId,n=e.recipeStore,i=e.plannedRecipe,o=e.onDelete,l=e.onUpdate,c=null!==(t=n.get(i.getRecipeId()))&&void 0!==t?t:M.error,s=Object(Oe.a)({item:{type:"recipe",plannedRecipe:i,from:a},collect:function(e){return{isDragging:!!e.isDragging()}}}),u=Object(E.a)(s,2),g=u[0].isDragging,f=u[1],h=new Intl.Collator,v=c.getLabels().sort(h.compare).map((function(e){return r.a.createElement(d.a,{key:e,sm:"auto",className:"mealee-bucker-recipe-label mt-1 ml-2"},e)}));return r.a.createElement("div",{ref:f,className:"hover",style:{position:"relative",width:"100%",height:"100%",opacity:g?.5:1,cursor:"move"}},r.a.createElement(pe.a,{className:"mealee-bucket-recipe"},r.a.createElement(pe.a.Body,{className:"mealee-bucket-recipe-body"},r.a.createElement(m.a,null,r.a.createElement(p.a,null,r.a.createElement(d.a,{className:"pl-0 ml-2"},c.getTitle())),r.a.createElement(p.a,null,v)))),r.a.createElement("div",{className:"hover-on",style:{position:"absolute",top:0,right:0,height:40,width:20,zIndex:1,opacity:.5}},r.a.createElement(I.a,{height:"18",onClick:function(){return o(c.getId())},style:{cursor:"pointer"}}),r.a.createElement(se.a,{placement:"auto",overlay:r.a.createElement(ue.a,{id:"popover-recipe-quick-view",className:"recipe-quick-view"},r.a.createElement(ue.a.Title,{as:"h4"},c.getTitle()),r.a.createElement(ue.a.Content,null,r.a.createElement(Ne,{recipe:c})))},r.a.createElement(fe.a,{height:"18",style:{cursor:"pointer"}}))),r.a.createElement("div",{className:"hover-on",style:{position:"absolute",top:0,left:3,height:20,width:25,zIndex:1,opacity:.5}},r.a.createElement(se.a,{key:"new",placement:"right",overlay:r.a.createElement(me.a,{id:"tooltip-new"},"Scroll up/down to change")},r.a.createElement("div",{onWheel:function(e){var t=e.deltaY>0?Math.max(1,i.getServing()-1):Math.min(9,i.getServing()+1);l(new X(i.getRecipeId(),t))}},r.a.createElement("span",{style:{fontSize:12,paddingTop:2,paddingRight:0}},i.getServing()),r.a.createElement(ye.a,{height:"12"})))))},Fe=function(e){var t=e.bucketId,a=e.recipeStore,n=e.plannedRecipes,i=e.onDelete,o=e.onUpdate;return r.a.createElement(pe.a,{className:"mealee-bucket"},r.a.createElement(pe.a.Header,{className:"mealee-bucket-header"},"Day "+(t+1)),r.a.createElement(pe.a.Body,{className:"mealee-bucket-body"},n.map((function(e){return r.a.createElement(je,{key:e.getRecipeId(),bucketId:t,recipeStore:a,plannedRecipe:e,onDelete:function(e){return i(t,e)},onUpdate:function(e){return o(t,e)}})}))))},Re=function(e){var t=e.bucketId,a=e.recipeStore,n=e.plannedRecipes,i=e.onDrop,o=e.onMove,l=e.onDelete,c=e.onUpdate,s=Object(xe.a)({accept:"recipe",drop:function(e){var n=e;if(void 0!==n.from&&void 0!==n.plannedRecipe)o(n.from,t,n.plannedRecipe);else{var r=a.get(n.id);i(t,new X(n.id,r?r.getServing():0))}},collect:function(e){return{isOver:!!e.isOver()}}}),u=Object(E.a)(s,2),m=u[0].isOver,p=u[1];return r.a.createElement("div",{ref:p,style:{position:"relative",width:"100%",height:"100%"}},r.a.createElement(Fe,{bucketId:t,recipeStore:a,plannedRecipes:n,onDelete:l,onUpdate:c}),m&&r.a.createElement("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",zIndex:1,opacity:.5,backgroundColor:"yellow"}}))},Be=function(e){var t=e.recipeStore,a=e.plan,n=e.updatePlan,i=function(e,t){n(a.setPlannedRecipe(e,t))},o=function(e,t){n(a.deleteRecipeById(e,t))},l=function(e,t){n(a.setPlannedRecipe(e,t))},c=function(e,t,r){n(a.deleteRecipeById(e,r.getRecipeId()).setPlannedRecipe(t,r))},s=B.a.range(a.getNrBuckets()).map((function(e){return r.a.createElement(d.a,{key:e,xs:"auto",className:"pr-2 pl-0"},r.a.createElement(Re,{bucketId:e,recipeStore:t,plannedRecipes:a.getPlannedRecipes(e),onDrop:i,onDelete:o,onUpdate:l,onMove:c}))}));return r.a.createElement(m.a,{className:"pt-0 pb-2 pl-0 pr-0"},r.a.createElement(p.a,null,s))},Le=a(112);function De(){var e=this;return r.a.createElement(d.a,{xs:"auto",className:"pt-3"},r.a.createElement(Le.a,{isOpen:this.state.isInitialTour,onRequestClose:function(){return e.setIsInitialTour(!1)},steps:[{selector:".my-first-step-a",content:r.a.createElement(m.a,{className:"pt-4"},"Load some recipes from a file or ...")},{selector:".my-first-step-b",content:r.a.createElement(m.a,{className:"pt-4"},"... or add a new recipe manually!")}]}),r.a.createElement(g.a,{key:"recipe",variant:"warning"},"I do not see any recipes. ",r.a.createElement(f.a,{variant:"link",className:"pt-1",onClick:function(){return e.setIsInitialTour(!0)}},"Are you new to Mealee?")))}function Te(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{xs:"8",sm:"5",md:"4",lg:"3",xl:"3",className:"h-100",style:{minHeight:0}},r.a.createElement(Ie,{plan:this.state.plan,scoring:this.state.recipeStore.scoreBy(this.state.plan,this.state.settings.getScoringFuns()),recipeStore:this.state.recipeStore,onEdit:this.editRecipe})),r.a.createElement(d.a,null,r.a.createElement(m.a,{className:"pt-2 pl-0 pr-0"},r.a.createElement(p.a,null,r.a.createElement(d.a,null,r.a.createElement(Be,{recipeStore:this.state.recipeStore,plan:this.state.plan,updatePlan:this.updatePlan}))),this.state.plan.getNrRecipes()>0&&r.a.createElement(p.a,null,r.a.createElement(d.a,{className:"pl-0"},r.a.createElement(f.a,{variant:"mealee",onClick:this.showDialog(Y.SavePlanXLS)},"Export plan \xa0",r.a.createElement(ae.a,{src:"xlsx_logo.svg",height:"18"})),r.a.createElement(f.a,{className:"ml-2",variant:"mealee",onClick:this.showDialog(Y.ShoppingList)},"Show shopping list \xa0",r.a.createElement(ae.a,{src:"todoist_logo.svg",height:"18"})))))))}var Ae=function(){function e(t,a,n){Object(l.a)(this,e),this.recipes=void 0,this.settings=void 0,this.lastUpdated=void 0,this.recipes=t,this.settings=a,this.lastUpdated=null!==n&&void 0!==n?n:new Date}return Object(c.a)(e,[{key:"getRecipes",value:function(){return this.recipes}},{key:"getSettings",value:function(){return this.settings}},{key:"getLastUpdated",value:function(){return this.lastUpdated}}]),e}();Ae.prototype.serialize=function(){var e=JSON.stringify({fileVersion:1,recipes:this.getRecipes(),settings:this.getSettings(),lastUpdated:this.getLastUpdated().toISOString()}),t=(new TextEncoder).encode(e);return new Blob([t],{type:"application/json;charset=utf-8"})};var Me=a(181),Pe=a(182),Ue=a(183),ze=a(184),Je=a(185),_e=function(e){var t=e.wsInfo;return r.a.createElement(m.a,null,r.a.createElement(p.a,null,r.a.createElement(d.a,{xs:6},"Last updated:"),r.a.createElement(d.a,{sm:"auto"},t.lastUpdated?t.lastUpdated.toLocaleString():"-")),r.a.createElement(p.a,null,r.a.createElement(d.a,{xs:6},"Number of recipes:"),r.a.createElement(d.a,{sm:"auto"},t.nrRecipes)))},He=function(e){var t=e.onLoadFile,a=e.onNewRecipe,n=e.onSaveFile,i=e.onEditSettings,o=e.unsavedChanges,l=e.wsInfo;return r.a.createElement(m.a,{className:"pl-0 ml-2 mr-2 p-0"},r.a.createElement(p.a,{className:"mb-4"},r.a.createElement(d.a,{className:"pr-0"},r.a.createElement(se.a,{key:"upload",placement:"right",overlay:r.a.createElement(me.a,{id:"tooltip-upload"},"Load recipes and settings")},r.a.createElement(Me.a,{className:"my-first-step-a",style:{color:"#ffffff",cursor:"pointer"},onClick:t})))),r.a.createElement(p.a,{className:"mb-4"},r.a.createElement(d.a,{className:"pr-0"},r.a.createElement(se.a,{key:"download",placement:"right",overlay:r.a.createElement(me.a,{id:"tooltip-download"},"Save recipes and settings")},o?r.a.createElement(Pe.a,{className:"text-warning",style:{cursor:"pointer"},onClick:n}):r.a.createElement(Pe.a,{style:{color:"#ffffff40"}})))),r.a.createElement(p.a,{className:"mb-4"},r.a.createElement(d.a,{className:"pr-0"},r.a.createElement(se.a,{key:"new",placement:"right",overlay:r.a.createElement(me.a,{id:"tooltip-new"},"Add new recipe")},r.a.createElement(Ue.a,{className:"my-first-step-b",style:{color:"#ffffff",cursor:"pointer"},onClick:a})))),r.a.createElement(p.a,{className:"mb-4"},r.a.createElement(d.a,{className:"pr-0"},r.a.createElement(se.a,{key:"info",placement:"right",overlay:r.a.createElement(ue.a,{id:"popover-info",className:"quick-info"},r.a.createElement(ue.a.Title,null,"Recipes information"),r.a.createElement(ue.a.Content,null,r.a.createElement(_e,{wsInfo:l})))},r.a.createElement(ze.a,{style:{color:"#ffffff",cursor:"pointer"}})))),r.a.createElement(p.a,{className:"mb-4"},r.a.createElement(d.a,{className:"pr-0"},r.a.createElement(se.a,{key:"settings",placement:"right",overlay:r.a.createElement(me.a,{id:"tooltip-settings"},"Settings")},r.a.createElement(Je.a,{style:{color:"#ffffff",cursor:"pointer"},onClick:i})))))},Ge=a(190),qe=a(101);var We,Ve=function(){return r.a.createElement(Ge.a,{bg:"mealee-menu",variant:"dark",className:"pl-1"},r.a.createElement(Ge.a.Brand,{className:"logo mr-2",href:"#home"},r.a.createElement(ae.a,{src:"mealee_logo_v9.svg",height:60})),r.a.createElement(Ge.a.Brand,{style:{marginTop:40}},r.a.createElement("span",{style:{fontFamily:"'Baloo 2', cursive",fontWeight:500,fontSize:30}},"meal planning for geeks")),r.a.createElement(Ge.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(Ge.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(qe.a,{className:"container-fluid"},r.a.createElement(qe.a.Item,{className:"ml-auto"},r.a.createElement("span",{style:{fontFamily:"'Baloo 2', cursive",fontWeight:600,fontSize:20,color:"#D1EdF230"}},"v","".concat("0.5.6"))))))},Xe=a(117),Ke=a(54);a(152);!function(e){e[e.LoadFile=0]="LoadFile",e[e.SaveFile=1]="SaveFile",e[e.RecipeEditor=2]="RecipeEditor",e[e.SavePlanXLS=3]="SavePlanXLS",e[e.ShoppingList=4]="ShoppingList",e[e.PlanSettings=5]="PlanSettings"}(We||(We={}));var Ye=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).renderDialog=te,n.renderInitialBody=De,n.renderDesktopBody=Te,n.addRecipes=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.setState((function(a){var n=a.unsavedChanges||!(t&&0===a.recipeStore.count()),r={},i=a.recipeStore.addAll(e);return i!==a.recipeStore&&(r={recipeStore:i,unsavedChanges:n}),r}))},n.setIsInitialTour=function(e){n.setState({isInitialTour:e})},n.saveRecipe=function(e){n.addRecipes([e]),n.closeRecipeEditor()},n.onFileLoaded=function(e){var t,a=null===(t=e.target)||void 0===t?void 0:t.result;if("string"==typeof a)try{var r=function(e){var t=JSON.parse(e);if("object"===typeof t){var a=t;if(a.fileVersion||(a.fileVersion=1),"undefined"!==typeof a.fileVersion){if(1!==a.fileVersion)throw new Error("Invalid recipe file version");var n=a.lastUpdated?new Date(Date.parse(a.lastUpdated)):void 0;if(Array.isArray(a.recipes))return new Ae(a.recipes.map(M.fromJSON),a.settings?F.fromJSON(a.settings):new F,n)}}throw new Error("Invalid mealee file")}(a);n.addRecipes(r.getRecipes(),!0),n.updateSettings(r.getSettings(),!0),n.setState({lastUpdated:r.getLastUpdated()})}catch(i){n.setState({error:i.message})}n.closeDialog()},n.loadFile=function(e){var t=new FileReader;t.onload=function(e){return n.onFileLoaded(e)},t.readAsText(e,"UTF-8")},n.genRecipeFileContent=function(){return new Ae(n.state.recipeStore.all(),n.state.settings).serialize()},n.fileSaved=function(){n.setState({unsavedChanges:!1,lastUpdated:new Date}),n.closeDialog()},n.showDialog=function(e){return function(){return n.setState({showDialog:e})}},n.closeDialog=function(){n.setState({showDialog:void 0})},n.closeRecipeEditor=function(){n.setState({recipeToEdit:void 0,showDialog:void 0})},n.dismissError=function(){n.setState({error:null})},n.updateSettings=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.setState((function(a){return{settings:e,unsavedChanges:!t,plan:a.plan.setNrBuckets(e.getNrBuckets()),showDialog:void 0}}))},n.updatePlan=function(e){n.setState({plan:e})},n.editRecipe=function(e){n.setState({showDialog:We.RecipeEditor,recipeToEdit:e})},n.deleteRecipe=function(e){n.setState((function(t){return{recipeStore:t.recipeStore.delete(e.getId()),showDialog:void 0,recipeToEdit:void 0,unsavedChanges:!0}}))};var r=new J,i=new F,o=K.new(i.getNrBuckets());return n.state={recipeStore:r,settings:i,plan:o,showDialog:void 0,recipeToEdit:void 0,error:null,unsavedChanges:!1,isInitialTour:!1},n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(m.a,{fluid:!0,className:"d-flex flex-column vh-100"},r.a.createElement(g.a,{variant:"danger",onClose:this.dismissError,show:!!this.state.error,dismissible:!0},this.state.error),this.state.unsavedChanges&&r.a.createElement(Xe.a,{onBeforeunload:function(){return"You'll lose your data!"}}),this.renderDialog(),r.a.createElement(p.a,null,r.a.createElement(d.a,null,r.a.createElement(Ve,null))),Ke.isMobileOnly?r.a.createElement(p.a,null,r.a.createElement(d.a,{className:"mt-3"},r.a.createElement(g.a,{key:"recipe",variant:"danger"},"Mobile is not supported as for now. Please try it on a little bit bigger device. Sorry for that."))):r.a.createElement(p.a,{className:"h-100",style:{minHeight:0}},r.a.createElement(d.a,{xs:"auto",className:"pl-0 pr-2 pt-3"},r.a.createElement(He,{onLoadFile:this.showDialog(We.LoadFile),onNewRecipe:this.showDialog(We.RecipeEditor),onSaveFile:this.showDialog(We.SaveFile),onEditSettings:this.showDialog(We.PlanSettings),unsavedChanges:this.state.unsavedChanges,wsInfo:{lastUpdated:this.state.lastUpdated,nrRecipes:this.state.recipeStore.count()}})),0===this.state.recipeStore.count()&&this.renderInitialBody(),this.state.recipeStore.count()>0&&!Ke.isMobileOnly&&this.renderDesktopBody()))}}]),a}(r.a.Component),Qe=a(88),Ze=a(186),$e=a(114),et=a(115);Qe.a.initialize("UA-74643376-3"),Qe.a.pageview("/"),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ze.a,{backend:Ke.isMobile?et.a:$e.a},r.a.createElement(Ye,null))),document.getElementById("root"))},94:function(e,t){}},[[124,1,2]]]);
//# sourceMappingURL=main.3b1044a8.chunk.js.map