(this.webpackJsonpmealee=this.webpackJsonpmealee||[]).push([[0],{100:function(e,t){},129:function(e,t,n){},147:function(e,t){},148:function(e,t){},156:function(e,t,n){"use strict";n.r(t);var i=n(1),r=(n(129),n(0)),a=n.n(r),s=n(17),c=n.n(s),o=n(15),l=n(23),u=n(123),d=n(121),h=n(167),j=n(169),p=n(104),g=n(184),b=n(164),f=n(192),m=n(193),v=n(10),O=n(103),x=function(e){var t=e.title,n=e.loadButtonTitle,r=e.onClose,s=e.onLoad,c=a.a.useState(null),o=Object(v.a)(c,2),l=o[0],u=o[1];return Object(i.jsxs)(f.a,{show:!0,onHide:r,children:[Object(i.jsx)(f.a.Header,{closeButton:!0,children:Object(i.jsx)(f.a.Title,{children:t})}),Object(i.jsx)(f.a.Body,{children:Object(i.jsx)(m.a,{children:Object(i.jsx)(O.a,{type:"file",onChange:function(e){e.target.files?u(e.target.files[0]):u(null)}})})}),Object(i.jsxs)(f.a.Footer,{children:[Object(i.jsx)(b.a,{type:"button",variant:"secondary",onClick:r,children:"Close"}),Object(i.jsx)(b.a,{type:"button",variant:"primary",disabled:!l,onClick:function(){l&&s(l)},children:n})]})]})},y=n(105),S=n.n(y),w=function(e){var t=e.title,n=e.saveButtonTitle,r=e.onClose,s=e.onSave,c=e.data,o=e.type,l=e.initialFileName,u=e.extension,d=a.a.useState(l),h=Object(v.a)(d,2),j=h[0],p=h[1];return Object(i.jsxs)(f.a,{show:!0,onHide:r,children:[Object(i.jsx)(f.a.Header,{closeButton:!0,children:Object(i.jsx)(f.a.Title,{children:t})}),Object(i.jsx)(f.a.Body,{children:Object(i.jsx)(m.a,{children:Object(i.jsxs)(m.a.Group,{controlId:"formBasicFileName",children:[Object(i.jsx)(m.a.Label,{children:"File name"}),Object(i.jsx)(m.a.Control,{type:"fileName",value:j,onChange:function(e){return p(e.target.value)}})]})})}),Object(i.jsxs)(f.a.Footer,{children:[Object(i.jsx)(b.a,{type:"button",variant:"secondary",onClick:r,children:"Close"}),Object(i.jsx)(b.a,{type:"button",variant:"primary",disabled:!j||0===j.length,onClick:function(){S()(c,j+"."+u,o),s()},children:n})]})]})},k=n(198),N=n(166),C=n(168),I=n(165),R=function(){function e(t,n){Object(o.a)(this,e),this.name=void 0,this.script=void 0,this.name=t,this.script=n}return Object(l.a)(e,[{key:"toJSON",value:function(){return{name:this.name,script:this.script}}},{key:"getName",value:function(){return this.name}},{key:"getScript",value:function(){return this.script}}],[{key:"fromJSON",value:function(t){if(!t.name)throw new Error("Missing name field");if(!t.script)throw new Error("Missing script field");return new e(t.name,t.script)}}]),e}(),F=function(){function e(t){Object(o.a)(this,e),this.json=void 0,this.json=t?t.toJSON():{}}return Object(l.a)(e,[{key:"buckets",value:function(e){return this.json.nrBuckets=e,this}},{key:"scoringFuns",value:function(e){return this.json.scoringFuns=e,this}},{key:"build",value:function(){return L.fromJSON(this.json)}}]),e}(),L=function(){function e(){Object(o.a)(this,e),this.nrBuckets=void 0,this.scoringFuns=void 0,this.nrBuckets=7,this.scoringFuns=[]}return Object(l.a)(e,[{key:"toJSON",value:function(){return{nrBuckets:this.nrBuckets,scoringFuns:this.scoringFuns.map((function(e){return e.toJSON()}))}}},{key:"getNrBuckets",value:function(){return this.nrBuckets}},{key:"getScoringFuns",value:function(){return this.scoringFuns}}],[{key:"builder",value:function(e){return new F(e)}},{key:"fromJSON",value:function(t){if(t.nrBuckets||(t.nrBuckets=7),t.nrBuckets<1||t.nrBuckets>7)throw new Error("Wrong number of recipes");t.scoringFuns||(t.scoringFuns=[]);var n=new e;return n.nrBuckets=t.nrBuckets,n.scoringFuns=t.scoringFuns.map((function(e){return R.fromJSON(e)})),n}}]),e}(),B=n(11),D=n.n(B),T=function(e){var t=a.a.useState(!1),n=Object(v.a)(t,2),r=n[0],s=n[1],c=a.a.useState(e.settings.toJSON()),o=Object(v.a)(c,2),l=o[0],u=o[1],d=function(e){return l.scoringFuns[e].name.trim().length>0},j=function(e){return l.scoringFuns[e].script.trim().length>0},p=l.scoringFuns.map((function(e,t){return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{style:{width:150},children:Object(i.jsx)(m.a.Control,{isInvalid:!d(t),className:"mealee-table-edit",type:"name",size:"sm",value:e.name,onChange:function(e){return function(e,t){var n=Object.assign({},l);n.scoringFuns[e].name=t,u(n),s(!0)}(t,e.currentTarget.value)}})}),Object(i.jsx)("td",{children:Object(i.jsx)(m.a.Control,{isInvalid:!j(t),rows:j(t)?e.script.split(/\r\n|\r|\n/).length+1:1,as:"textarea",className:"mealee-table-edit",type:"name",size:"sm",style:{height:"100%"},value:e.script,onChange:function(e){return function(e,t){var n=Object.assign({},l);n.scoringFuns[e].script=t,u(n),s(!0)}(t,e.currentTarget.value)}})}),Object(i.jsx)("td",{style:{width:30},children:Object(i.jsx)(I.a,{onClick:function(){return function(e){var t=Object.assign({},l);t.scoringFuns=D.a.concat(D.a.take(t.scoringFuns,e),D.a.drop(t.scoringFuns,e+1)),u(t),s(!0)}(t)},style:{cursor:"pointer"}})})]})}));return Object(i.jsxs)(f.a,{show:!0,onHide:e.onClose,dialogClassName:"mealee-settings-dialog",children:[Object(i.jsx)(f.a.Header,{closeButton:!0,children:Object(i.jsx)(f.a.Title,{children:"Settings"})}),Object(i.jsx)(f.a.Body,{style:{width:800},children:Object(i.jsxs)(k.a,{defaultActiveKey:"general",children:[Object(i.jsx)(N.a,{eventKey:"general",title:"General",children:Object(i.jsx)(h.a,{className:"p-3",children:Object(i.jsx)(m.a,{onSubmit:function(e){return e.preventDefault()},children:Object(i.jsxs)(m.a.Group,{controlId:"nrRecipes",children:[Object(i.jsx)(m.a.Label,{children:"Number of recipes:"}),Object(i.jsxs)(m.a.Control,{as:"select",value:l.nrBuckets,onChange:function(e){return function(e){var t=Object.assign({},l);t.nrBuckets=e,u(t),s(!0)}(parseInt(e.target.value))},children:[Object(i.jsx)("option",{children:"3"},"3"),Object(i.jsx)("option",{children:"4"},"4"),Object(i.jsx)("option",{children:"5"},"5"),Object(i.jsx)("option",{children:"6"},"6"),Object(i.jsx)("option",{children:"7"},"7")]})]})})})}),Object(i.jsx)(N.a,{eventKey:"scoring",title:"Scoring",className:"h-100",children:Object(i.jsx)(h.a,{className:"p-3 h-100 d-flex flex-column",children:Object(i.jsxs)(m.a,{onSubmit:function(e){return e.preventDefault()},className:"h-100 d-grow-1",children:[Object(i.jsx)("div",{className:"p-0 tableFixHead",children:Object(i.jsxs)(C.a,{hover:!0,size:"sm",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"Name"}),Object(i.jsx)("th",{children:"Expression"}),Object(i.jsx)("th",{className:"m-0 p-0",style:{width:0},children:"\xa0"})]})}),Object(i.jsx)("tbody",{children:p})]})}),Object(i.jsx)(b.a,{onClick:function(){var e=Object.assign({},l);e.scoringFuns=e.scoringFuns.concat([{name:"new scoring fun",script:"random(1)"}]),u(e),s(!0)},children:"Add scoring function"})]})})})]})}),Object(i.jsxs)(f.a.Footer,{children:[Object(i.jsx)(b.a,{type:"button",variant:"primary",onClick:function(){e.onSave(L.fromJSON(l))},disabled:!r,children:"Save"}),Object(i.jsx)(b.a,{type:"button",variant:"secondary",onClick:e.onClose,children:"Close"})]})]})},U=n(21),E=n(118),A=function(){function e(t,n,i){Object(o.a)(this,e),this.name=void 0,this.amount=void 0,this.unit=void 0,this.name=t,this.amount=n,this.unit=i}return Object(l.a)(e,[{key:"getName",value:function(){return this.name}},{key:"getAmount",value:function(){return this.amount}},{key:"getUnit",value:function(){return this.unit}},{key:"toJSON",value:function(){return{name:this.name,amount:this.amount,unit:this.unit}}}],[{key:"fromJSON",value:function(t){if(!t.name)throw new Error("Missing ingredient name");if(!t.unit)throw new Error("Missing ingredient unit");if(void 0===t.amount)throw new Error("Missing ingredient amount");return new e(t.name,t.amount,t.unit)}}]),e}();var M=function(){function e(t,n){Object(o.a)(this,e),this.id=void 0,this.title=void 0,this.comment=void 0,this.source=void 0,this.serving=void 0,this.ingredients=void 0,this.labels=void 0,this.imageURL=void 0,this.id=t,this.title=n,this.ingredients=[],this.labels=[],this.serving=4}return Object(l.a)(e,[{key:"getId",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getComment",value:function(){return this.comment}},{key:"getSource",value:function(){return this.source}},{key:"getServing",value:function(){return this.serving}},{key:"getIngredients",value:function(){return this.ingredients}},{key:"getLabels",value:function(){return this.labels}},{key:"getImageURL",value:function(){return this.imageURL}},{key:"toJSON",value:function(){return{id:this.id,title:this.title,comment:this.comment,source:this.source,serving:this.serving,ingredients:this.ingredients.map((function(e){return e.toJSON()})),labels:this.labels,imageURL:this.imageURL}}}],[{key:"fromJSON",value:function(t){var n,i;if(t.id||(t.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))),!t.title)throw new Error("Missing recipe title");var r=new e(t.id,t.title);return r.comment=t.comment,r.source=t.source,r.serving=null!==(n=t.serving)&&void 0!==n?n:4,r.labels=null!==(i=t.labels)&&void 0!==i?i:[],r.imageURL=t.imageURL,Array.isArray(t.ingredients)&&(r.ingredients=t.ingredients.map((function(e){return A.fromJSON(e)}))),r}}]),e}();M.error=new M("error","Recipe cannot be found");var P=n(45),z=n(108),J=n(20),_=function e(t,n){var i=this;Object(o.a)(this,e),this.recipesMap=void 0,this.index=void 0,this.fieldAccessors=[function(e){return e.getTitle()},function(e){var t;return null!==(t=e.getComment())&&void 0!==t?t:""},function(e){var t;return null!==(t=e.getSource())&&void 0!==t?t:""},function(e){return e.getIngredients().map((function(e){return e.getName()})).join(" ")},function(e){return e.getLabels().join(" ")}],this.fieldBoostFactors=[2,1,1,1,2],this.termFilter=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},this.add=function(t){var n=t.getId(),r=!0;if(i.recipesMap.has(n)&&JSON.stringify(i.recipesMap.get(n))===JSON.stringify(t)&&(r=!1),r){i.delete(n);var a=i.recipesMap.set(n,t);return Object(P.a)(i.index,i.fieldAccessors,B.words,i.termFilter,n,t),new e(i.index,a)}return i},this.addAll=function(e){return e.reduce((function(e,t){return e.add(t)}),i)},this.search=function(e){return Object(z.a)(i.index,i.fieldBoostFactors,1.2,.75,B.words,i.termFilter,void 0,e).reduce((function(e,t){var n=i.recipesMap.get(t.key);return n&&e.push({key:n,score:t.score}),e}),[])},this.all=function(){return Array.from(i.recipesMap.values())},this.get=function(e){return i.recipesMap.get(e)},this.delete=function(t){if(i.recipesMap.has(t)){var n=i.recipesMap.delete(t);return Object(P.d)(i.index,new Set,t),new e(i.index,n)}return i},this.getAll=function(e){return e.reduce((function(e,t){var n=i.recipesMap.get(t);return n?e.push(n):e.push(M.error),e}),[])},this.count=function(){return i.recipesMap.size},this.index=t||Object(P.b)(this.fieldAccessors.length),this.recipesMap=n||Object(J.b)({})};_.new=function(){return new _},_.prototype.getIngredients=function(){var e=new Set;this.all().forEach((function(t){t.getIngredients().forEach((function(t){e.add(t.getName().toLowerCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)},_.prototype.getUnits=function(){var e=new Set;this.all().forEach((function(t){t.getIngredients().forEach((function(t){e.add(t.getUnit().toLowerCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)},_.prototype.getLabels=function(){var e=new Set;this.all().forEach((function(t){t.getLabels().forEach((function(t){e.add(t.toUpperCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)};var H=n(18),G=n.n(H);n(137),n(138),n(139),n(140),n(97),n(141),n(142);function q(e,t){for(var n=[],i=e.split(/\r?\n/),r=0;r<i.length;r++){var a=i[r];if(a.trim().length>0){var s=a.split(";");if(s.length<3)t.push({from:G.a.Pos(r,0),to:G.a.Pos(r,a.length),message:"Not enough parts. Syntax: <name>;<amount>;<unit>"});else if(s.length>3){var c=s[0].length+s[1].length+s[2].length+2;t.push({from:G.a.Pos(r,c),to:G.a.Pos(r,a.length),message:"Too many parts. Syntax: <name>;<amount>;<unit>"})}else{var o=s[0].length+1,l=o+s[1].length;0===(s=s.map((function(e){return e.trim()})))[0].length||0===s[1].length||0===s[2].length?t.push({from:G.a.Pos(r,0),to:G.a.Pos(r,a.length),message:"Empty part(s). Syntax: <name>;<amount>;<unit>"}):""+Number.parseFloat(s[1])!==s[1]?t.push({from:G.a.Pos(r,o),to:G.a.Pos(r,l),message:"Amount should be a number."}):n.push({name:s[0],amount:Number.parseFloat(s[1]),unit:s[2]})}}}return n}function W(e,t){return function(n){var i=n.getCursor(),r=n.getLine(i.line),a=i.ch,s=i.ch,c=(r.substring(0,s).match(/;/g)||[]).length;if(0!==c&&2!==c)return null;for(;a&&";"!==r.charAt(a-1);)--a;for(;s<r.length&&";"!==r.charAt(s);)++s;var o=r.slice(a,s).trimLeft().toLowerCase(),l=0===c?e.filter((function(e){return e.indexOf(o)>=0})):t.filter((function(e){return e.startsWith(o)}));return 1===l.length&&l[0]===o&&(l=[]),{list:l,from:G.a.Pos(i.line,a),to:G.a.Pos(i.line,s)}}}G.a.defineMode("ingredients",(function(){var e=0,t=1,n=2,i=3;return{startState:function(){return{location:e}},token:function(r,a){r.sol()&&(a.location=e);var s=r.next();return";"===s&&(a.location===e?a.location=t:a.location===t?a.location=n:a.location=i),a.location===i?"error":";"===s?"keyword":a.location===e?(r.eatWhile((function(e){return";"!==e})),"atom"):a.location===t?(r.eatWhile((function(e){return";"!==e})),"number"):a.location===n?(r.eatWhile((function(e){return";"!==e})),"atom"):"error"}}})),G.a.registerHelper("lint","ingredients",(function(e){var t=[];return q(e,t),t}));var V=function(e){var t=a.a.useState(e.recipe?e.recipe.toJSON():Object.create({})),n=Object(v.a)(t,2),r=n[0],s=n[1],c=a.a.useState(!e.recipe),o=Object(v.a)(c,2),l=o[0],u=o[1],d=a.a.useState(!1),h=Object(v.a)(d,2),j=h[0],p=h[1],g=a.a.useState(e.recipe?e.recipe.getIngredients().map((function(e){return e.getName()+";"+e.getAmount()+";"+e.getUnit()})).join("\n"):""),O=Object(v.a)(g,2),x=O[0],y=O[1],S=e.recipeStore.getLabels().map((function(e){return{value:e,label:e}})),w=r.labels?r.labels.map((function(e){return{value:e.toUpperCase(),label:e.toUpperCase()}})):[],k=a.a.createRef(),N=a.a.createRef();return Object(i.jsxs)(f.a,{show:!0,onHide:e.onClose,onEntered:function(){if(k.current&&k.current.focus(),N.current){var t=G.a.fromTextArea(N.current,{lineNumbers:!1,mode:"ingredients",gutters:["CodeMirror-lint-markers"],lint:!0,extraKeys:{"Ctrl-Space":"autocomplete"}});t.on("change",(function(e){!function(e){y(e);var t=[],n=q(e,t);t.length>0?p(!0):(p(!1),s((function(e){return Object(U.a)(Object(U.a)({},e),{ingredients:n})})))}(e.getValue())})),t.on("cursorActivity",(function(t){t.showHint({hint:W(e.recipeStore.getIngredients(),e.recipeStore.getUnits()),completeSingle:!1,closeOnUnfocus:!0})}))}},children:[Object(i.jsx)(f.a.Header,{closeButton:!0,children:Object(i.jsxs)(f.a.Title,{children:[e.recipe?"Edit":"Add new "," recipe"]})}),Object(i.jsx)(f.a.Body,{children:Object(i.jsxs)(m.a,{children:[Object(i.jsxs)(m.a.Group,{controlId:"formTitle",children:[Object(i.jsx)(m.a.Control,{type:"title",value:r.title,placeholder:"Title",isInvalid:l,onChange:function(e){var t=e.currentTarget.value;u(!t||0===t.length),s((function(e){return Object(U.a)(Object(U.a)({},e),{title:t})}))},ref:k,size:"sm"}),Object(i.jsx)(m.a.Control.Feedback,{type:"invalid",children:"Required field!"})]}),Object(i.jsxs)(m.a.Group,{controlId:"formImageURL",children:[Object(i.jsx)(m.a.Control,{type:"imageURL",value:r.imageURL,placeholder:"Image URL",onChange:function(e){var t=e.currentTarget.value;s((function(e){return Object(U.a)(Object(U.a)({},e),{imageURL:t})}))},size:"sm"}),Object(i.jsx)(m.a.Control.Feedback,{type:"invalid",children:"Required field!"})]}),Object(i.jsx)(m.a.Group,{controlId:"formComment",children:Object(i.jsx)(m.a.Control,{as:"textarea",value:r.comment,onChange:function(e){var t=e.currentTarget.value;s((function(e){return Object(U.a)(Object(U.a)({},e),{comment:t})}))},rows:2,placeholder:"Comment",size:"sm"})}),Object(i.jsx)(m.a.Group,{controlId:"formSource",children:Object(i.jsx)(m.a.Control,{type:"source",value:r.source,onChange:function(e){var t=e.currentTarget.value;s((function(e){return Object(U.a)(Object(U.a)({},e),{source:t})}))},placeholder:"Where to find the recipe",size:"sm"})}),Object(i.jsx)(m.a.Group,{controlId:"formServing",children:Object(i.jsx)(m.a.Control,{type:"serving",value:r.serving,onChange:function(e){var t=Number.parseInt(e.currentTarget.value);isNaN(t)&&(t=void 0),s((function(e){return Object(U.a)(Object(U.a)({},e),{serving:t})}))},placeholder:"Number of porties",size:"sm"})}),Object(i.jsx)(m.a.Group,{controlId:"formLabel",children:Object(i.jsx)(E.a,{styles:{menu:function(e){return Object(U.a)(Object(U.a)({},e),{},{zIndex:9999})}},size:"sm",options:S,isMulti:!0,placeholder:"Labels",onChange:function(e){var t=e.map((function(e){return e.label}));s((function(e){return Object(U.a)(Object(U.a)({},e),{labels:t})}))},value:w})}),Object(i.jsx)(m.a.Group,{controlId:"formIngredients",children:Object(i.jsx)(m.a.Control,{as:"textarea",value:x,ref:N,placeholder:"Ingredients: <name>;<amount>;<unit>"})})]})}),Object(i.jsxs)(f.a.Footer,{children:[Object(i.jsx)(b.a,{type:"button",variant:"secondary",onClick:e.onClose,children:"Close"}),Object(i.jsx)(b.a,{type:"button",variant:"primary",onClick:function(){e.onSave(M.fromJSON(r))},disabled:l||j,children:"Save recipe"}),e.recipe&&Object(i.jsx)(b.a,{type:"button",variant:"primary",onClick:function(){e.recipe&&e.onDelete(e.recipe)},children:"Delete recipe"})]})]})},X=n(22),K=function(){function e(t,n){Object(o.a)(this,e),this.recipeId=void 0,this.serving=void 0,this.recipeId=t,this.serving=n}return Object(l.a)(e,[{key:"getRecipeId",value:function(){return this.recipeId}},{key:"getServing",value:function(){return this.serving}}]),e}(),Y=function(){function e(t){Object(o.a)(this,e),this.buckets=Object(J.a)(),this.buckets=t}return Object(l.a)(e,[{key:"setNrBuckets",value:function(t){return new e(this.buckets.setSize(t))}},{key:"getNrBuckets",value:function(){return this.buckets.size}},{key:"getNrRecipes",value:function(){var e,t=0,n=Object(X.a)(this.buckets);try{for(n.s();!(e=n.n()).done;){var i=e.value;i&&(t+=i.size)}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"setPlannedRecipe",value:function(t,n){var i,r=null!==(i=this.buckets.get(t))&&void 0!==i?i:Object(J.b)();return new e(this.buckets.set(t,r.set(n.getRecipeId(),n)))}},{key:"deleteRecipeById",value:function(t,n){var i,r=null!==(i=this.buckets.get(t))&&void 0!==i?i:Object(J.b)();return new e(this.buckets.set(t,r.delete(n)))}},{key:"getPlannedRecipes",value:function(e){var t,n=null!==(t=this.buckets.get(e))&&void 0!==t?t:Object(J.b)();return Array.from(n.valueSeq())}},{key:"getAllPlannedRecipes",value:function(){var e,t=Object(J.a)(),n=Object(X.a)(this.buckets);try{for(n.s();!(e=n.n()).done;){var i=e.value;i&&(t=t.concat(i.values()))}}catch(r){n.e(r)}finally{n.f()}return Array.from(t)}},{key:"getAllRecipeIds",value:function(){var e,t=Object(J.c)(),n=Object(X.a)(this.buckets);try{for(n.s();!(e=n.n()).done;){var i=e.value;i&&(t=t.concat(i.valueSeq().map((function(e){return e.getRecipeId()}))))}}catch(r){n.e(r)}finally{n.f()}return Array.from(t)}}]),e}();Y.new=function(e){return new Y(Object(J.a)().setSize(e))};var Q,Z=n(33),$=n.n(Z);function ee(e){var t=new Map;return e.forEach((function(e){var n=e[0],i=e[1];n.getIngredients().forEach((function(e){var r,a=e.getName().toLowerCase(),s=t.get(a);s||(s=new Map,t.set(a,s));var c=null!==(r=s.get(i))&&void 0!==r?r:[];c.push([e.getAmount(),e.getUnit().toLowerCase(),i.getServing()/n.getServing()]),s.set(i,c)}))})),t}function te(e,t){var n,i=t.map((function(t){var n,i,r=new Map,a=null!==(n=e.get(t))&&void 0!==n?n:new Map,s=Object(X.a)(a.values());try{for(s.s();!(i=s.n()).done;){var c,o=i.value,l=Object(X.a)(o);try{for(l.s();!(c=l.n()).done;){var u,d=Object(v.a)(c.value,3),h=d[0],j=d[1],p=d[2];r.set(j,(null!==(u=r.get(j))&&void 0!==u?u:0)+h*p)}}catch(g){l.e(g)}finally{l.f()}}}catch(g){s.e(g)}finally{s.f()}return{name:t,amounts:r}})),r=[],a=Object(X.a)(i);try{for(a.s();!(n=a.n()).done;){var s,c=n.value,o=c.name,l=c.amounts,u=[o],d=Object(X.a)(l);try{for(d.s();!(s=d.n()).done;){var h=Object(v.a)(s.value,2),j=h[0],p=h[1];u.push(p+" "+j)}}catch(g){d.e(g)}finally{d.f()}r.push(u)}}catch(g){a.e(g)}finally{a.f()}return r}function ne(){switch(this.state.showDialog){case Q.LoadFile:return Object(i.jsx)(x,{onClose:this.closeDialog,title:"Load recipes file",loadButtonTitle:"Load recipes",onLoad:this.loadFile});case Q.SaveFile:return Object(i.jsx)(w,{onClose:this.closeDialog,title:"Save recipes file",saveButtonTitle:"Save recipes",data:this.genRecipeFileContent(),type:"application/json",initialFileName:"recipes",extension:"json",onSave:this.fileSaved});case Q.RecipeEditor:return Object(i.jsx)(V,{onClose:this.closeRecipeEditor,onSave:this.saveRecipe,onDelete:this.deleteRecipe,recipe:this.state.recipeToEdit,recipeStore:this.state.recipeStore});case Q.SavePlanXLS:return Object(i.jsx)(w,{onClose:this.closeDialog,title:"Save plan",saveButtonTitle:"Save plan",data:this.state.plan.export(this.state.recipeStore),type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",initialFileName:"plan",extension:"xlsx",onSave:this.closeDialog});case Q.ShoppingList:return Object(i.jsxs)(f.a,{show:!0,onHide:this.closeDialog,children:[Object(i.jsx)(f.a.Header,{closeButton:!0,children:Object(i.jsx)(f.a.Title,{children:"Shopping list"})}),Object(i.jsx)(f.a.Body,{children:Object(i.jsx)(m.a,{children:Object(i.jsx)(m.a.Control,{as:"textarea",rows:20,cols:80,value:this.state.plan.exportShoppingList(this.state.recipeStore),readOnly:!0})})}),Object(i.jsx)(f.a.Footer,{children:Object(i.jsx)(b.a,{variant:"secondary",onClick:this.closeDialog,children:"Close"})})]});case Q.PlanSettings:return Object(i.jsx)(T,{onClose:this.closeDialog,settings:this.state.settings,onSave:this.updateSettings});default:return Object(i.jsx)(i.Fragment,{})}}Y.prototype.exportShoppingList=function(e){var t,n=this.getAllPlannedRecipes(),i=e.getAll(n.map((function(e){return e.getRecipeId()}))),r=ee(D.a.zip(i,n)),a=new Intl.Collator,s=Array.from(r.keys()).sort(a.compare),c=te(r,s),o="",l=Object(X.a)(c);try{for(l.s();!(t=l.n()).done;){var u=t.value;o+="**"+u.shift()+"**",o+=" - ",o+=u.join(" + "),o+="\n"}}catch(d){l.e(d)}finally{l.f()}return o},Y.prototype.export=function(e){var t=this,n=this.getAllPlannedRecipes(),i=e.getAll(n.map((function(e){return e.getRecipeId()}))),r=D.a.zip(i,n),a=new Set(i),s=ee(r),c=Array.from(s.keys()).sort(),o=$.a.utils.book_new(),l=D.a.range(0,this.getNrBuckets()).map((function(n){var i=t.getPlannedRecipes(n),r=e.getAll(i.map((function(e){return e.getRecipeId()}))),a=D.a.zip(r,i);return["Day #"+(n+1)].concat(a.map((function(e){return e[0].getTitle()+" ("+e[1].getServing()+" people)"})))})),u=$.a.utils.aoa_to_sheet(l);$.a.utils.book_append_sheet(o,u,"Plan");var d=te(s,c),h=$.a.utils.aoa_to_sheet(d);$.a.utils.book_append_sheet(o,h,"Shopping list");var j=r.map((function(e){return e[0].getTitle()+" ("+e[1].getServing()+" people)"}));j.unshift("");var p=c.map((function(e){var t,i=[e],r=Object(X.a)(n);try{for(r.s();!(t=r.n()).done;){var a,c=t.value,o=(null!==(a=s.get(e))&&void 0!==a?a:new Map).get(c);o?i.push(o.map((function(e){return e[0]*e[2]+" "+e[1]})).join(", ")):i.push("")}}catch(l){r.e(l)}finally{r.f()}return i})),g=[j].concat(p),b=$.a.utils.aoa_to_sheet(g);$.a.utils.book_append_sheet(o,b,"Ingredient map");var f,m=Object(X.a)(a);try{for(m.s();!(f=m.n()).done;){var v,O,x,y=f.value,S=[["Title",y.getTitle()],["Comment",null!==(v=y.getComment())&&void 0!==v?v:"-"],["Serves",y.getServing()],["Source",null!==(O=y.getSource())&&void 0!==O?O:"-"],["Ingredients:"]],w=Object(X.a)(y.getIngredients());try{for(w.s();!(x=w.n()).done;){var k=x.value;S.push([k.getName().toLowerCase(),k.getAmount(),k.getUnit().toLowerCase()])}}catch(R){w.e(R)}finally{w.f()}var N=$.a.utils.aoa_to_sheet(S),C=y.getTitle().substr(0,31).replace(/[[\]/\\:*?]/g,"_");$.a.utils.book_append_sheet(o,N,C)}}catch(R){m.e(R)}finally{m.f()}var I=$.a.write(o,{bookType:"xlsx",bookSST:!1,type:"array"});return new Blob([I],{type:"application/octet-stream"})},function(e){e[e.LoadFile=0]="LoadFile",e[e.SaveFile=1]="SaveFile",e[e.RecipeEditor=2]="RecipeEditor",e[e.SavePlanXLS=3]="SavePlanXLS",e[e.ShoppingList=4]="ShoppingList",e[e.PlanSettings=5]="PlanSettings"}(Q||(Q={}));var ie=n(176),re=function e(){var t=this;Object(o.a)(this,e),this.scorings=void 0,this.sum=void 0,this.addScoring=function(e,n){t.scorings.set(e,n),t.sum+=n},this.getSum=function(){return t.sum},this.getScorings=function(){return Array.from(t.scorings)},this.scorings=new Map,this.sum=0},ae=function e(){var t=this;Object(o.a)(this,e),this.scoring=void 0,this.sum=void 0,this.addScoring=function(e,n,i){var r;t.scoring.has(e)||t.scoring.set(e,new re),null===(r=t.scoring.get(e))||void 0===r||r.addScoring(n,i)},this.getSum=function(e){var n=t.scoring.get(e);return n?n.getSum():0},this.getScoring=function(e){return t.scoring.get(e)},this.scoring=new Map,this.sum=0},se=n(109);function ce(e){return D.a.countBy(e.getLabels().map((function(e){return e.toUpperCase()})))}function oe(e,t,n,i){return new Map(t.map((function(t){var n=e.evaluate({this:t,rrandom:i.get(t.getId())||0});return[t,n]})))}_.prototype.scoreBy=function(e,t,n){var i=new se.a,r=this.all(),a=new Map(r.map((function(e){return[e,ce(e)]}))),s=e.getAllPlannedRecipes().map((function(e){return e.getRecipeId()})),c=D.a.countBy(s),o=D.a.countBy(D.a.flatMap(this.getAll(s),(function(e){return e.getLabels()})).map((function(e){return e.toUpperCase()})));i.functions.intersection=function(e,t){return D.a.intersection(e,t)},i.functions.sum=function(e){return D.a.sum(e)},i.functions.ingredients=function(e){return e.getIngredients()},i.functions.hasLabel=function(e,t){var n=a.get(e);return!!n&&n[t]>0},i.functions.countLabelInPlan=function(e){var t;return null!==(t=o[e])&&void 0!==t?t:0},i.functions.countRecipeInPlan=function(e){var t;return null!==(t=c[e.getId()])&&void 0!==t?t:0};var l,u=new ae,d=Object(X.a)(t);try{var h=function(){var e=l.value,t=i.parse(e.getScript()),a=-1;i.functions.normalize=function(e){return e>a&&(a=e),e};var s=oe(t,r,0,n);a>0&&(i.functions.normalize=function(e){return e/a},s=oe(t,r,0,n));var c,o=Object(X.a)(s);try{for(o.s();!(c=o.n()).done;){var d=Object(v.a)(c.value,2),h=d[0],j=d[1];u.addScoring(h.getId(),e,j)}}catch(p){o.e(p)}finally{o.f()}};for(d.s();!(l=d.n()).done;)h()}catch(j){d.e(j)}finally{d.f()}return u};var le=n(180),ue=n(191),de=n(197),he=n(182),je=n(199),pe=n(200),ge=n(177),be=n(178),fe=n(179),me=n(181),ve=n(183),Oe=n(170),xe=n(171),ye=n(172),Se=n(173),we=n(174),ke=n(175),Ne=function(e){var t=e.recipe,n=e.scoring,r=new Intl.Collator,a=t.getIngredients().map((function(e){return e.getName()})).sort(r.compare).map((function(e){return Object(i.jsx)(p.a,{sm:"auto",className:"border mt-1 ml-2 pt-2 pb-2",children:e},e)})),s=t.getLabels().sort(r.compare).map((function(e){return Object(i.jsx)(p.a,{sm:"auto",className:"border mt-1 ml-2 pt-2 pb-2",children:e},e)})),c=n&&n.getScorings().map((function(e){return Object(i.jsxs)(j.a,{children:[Object(i.jsx)(p.a,{xs:"2",children:e[1].toFixed(2)}),Object(i.jsx)(p.a,{xs:"1",children:"\u2190"}),Object(i.jsx)(p.a,{children:e[0].getName()})]},e[0].getName())}));return Object(i.jsxs)(h.a,{className:"pl-0 pr-2",children:[t.getComment()&&Object(i.jsxs)(j.a,{className:"pb-2",children:[Object(i.jsx)(p.a,{sm:"auto",children:Object(i.jsx)(Oe.a,{height:"18"})}),Object(i.jsx)(p.a,{sm:"auto",children:t.getComment()})]}),t.getServing()&&Object(i.jsxs)(j.a,{className:"pb-2",children:[Object(i.jsx)(p.a,{sm:"auto",children:Object(i.jsx)(xe.a,{height:"18"})}),Object(i.jsx)(p.a,{sm:"auto",children:t.getServing()})]}),t.getSource()&&Object(i.jsxs)(j.a,{className:"pb-2",children:[Object(i.jsx)(p.a,{sm:"auto",children:Object(i.jsx)(ye.a,{height:"18"})}),Object(i.jsx)(p.a,{sm:"auto",children:t.getSource()})]}),Object(i.jsxs)(j.a,{className:"pb-2",children:[Object(i.jsx)(p.a,{xs:1,children:Object(i.jsx)(Se.a,{height:"18"})}),Object(i.jsx)(p.a,{children:Object(i.jsx)(h.a,{fluid:!0,className:"pl-0",children:Object(i.jsx)(j.a,{children:a})})})]}),t.getLabels().length>0&&Object(i.jsxs)(j.a,{className:"pb-2",children:[Object(i.jsx)(p.a,{xs:1,children:Object(i.jsx)(we.a,{height:"18"})}),Object(i.jsx)(p.a,{children:Object(i.jsx)(h.a,{fluid:!0,className:"pl-0",children:Object(i.jsx)(j.a,{children:s})})})]}),n&&Object(i.jsxs)(j.a,{children:[Object(i.jsx)(p.a,{xs:1,children:Object(i.jsx)(ke.a,{height:"18"})}),Object(i.jsx)(p.a,{children:Object(i.jsxs)(h.a,{className:"ml-0 pl-0",children:[c,Object(i.jsx)(j.a,{children:Object(i.jsx)(p.a,{xs:"2",className:"border",children:n.getSum().toFixed(2)})})]})})]})]})},Ce=n(195),Ie=a.a.forwardRef((function(e,t){var n=e.recipe,r=e.selected,a=e.scoring,s=e.highlighted,c=e.onEdit,o=Object(Ce.a)({item:{type:"recipe",id:n.getId()},collect:function(e){return{isDragging:!!e.isDragging()}}}),l=Object(v.a)(o,2),u=l[0].isDragging,d=l[1],g=new Intl.Collator,b=n.getLabels().sort(g.compare).map((function(e){return Object(i.jsx)(p.a,{sm:"auto",className:"mealee-recipe-selector-label mt-1 ml-2",children:e},e)})),f=(n.getImageURL()||"").length>0;return Object(i.jsxs)("div",{ref:t,className:"hover",style:{position:"relative",width:"100%",height:"100%",backgroundColor:"#FFFFFF"},children:[Object(i.jsx)(je.a,{className:s?"mealee-recipe-selector-item-highlighted":"mealee-recipe-selector-item",ref:d,style:{opacity:u||r?.5:1,cursor:"move"},children:Object(i.jsx)(je.a.Body,{className:"p-0",children:Object(i.jsxs)(h.a,{children:[Object(i.jsx)(j.a,{children:Object(i.jsx)(p.a,{className:"pl-0 ml-2",children:n.getTitle()})}),Object(i.jsx)(j.a,{children:b})]})})},n.getId()),Object(i.jsxs)("div",{className:"hover-on",style:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:10,height:20,width:f?60:40,zIndex:1,opacity:.5},children:[f&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(ue.a,{placement:"auto",overlay:Object(i.jsx)(ie.a,{src:n.getImageURL(),className:"recipe-image rounded"}),children:Object(i.jsx)(ge.a,{height:"18",style:{cursor:"pointer"}})}),"\xa0"]}),Object(i.jsx)(ue.a,{placement:"auto",overlay:Object(i.jsxs)(de.a,{id:"popover-recipe-quick-view",className:"recipe-quick-view",children:[Object(i.jsx)(de.a.Title,{as:"h4",children:n.getTitle()}),Object(i.jsx)(de.a.Content,{children:Object(i.jsx)(Ne,{recipe:n,scoring:a})})]}),children:Object(i.jsx)(be.a,{height:"18",style:{cursor:"pointer"}})}),"\xa0",Object(i.jsx)(fe.a,{height:"18",onClick:function(){return c(n)},style:{cursor:"pointer"}})]})]})})),Re=function(e){var t=e.recipeStore,n=e.scoring,s=e.plan,c=e.highlightedRecipes,o=e.onEdit,l=a.a.useState(""),u=Object(v.a)(l,2),d=u[0],h=u[1],j=a.a.useState(Object(J.c)()),p=Object(v.a)(j,2),g=p[0],b=p[1],f=a.a.useCallback(D.a.debounce(h,100),[]),x=0===d.trim().length?t.all():t.search(d).map((function(e){return e.key})),y=new Set(s.getAllRecipeIds()),S=null,w=D.a.sortBy(x,(function(e){return-1*n.getSum(e.getId())})).map((function(e){var t=c.has(e.getId()),r=t&&!S?a.a.createRef():null;return r&&(S=r),Object(i.jsx)(pe.a.Item,{className:"p-0",children:Object(i.jsx)(Ie,{ref:r,recipe:e,scoring:n.getScoring(e.getId()),onEdit:o,selected:y.has(e.getId()),highlighted:t},e.getId())},e.getId())}));return Object(r.useEffect)((function(){S&&c!==g&&S.current&&(S.current.scrollIntoView({behavior:"smooth",block:"start"}),b(c))}),[S,c,g]),Object(i.jsxs)(m.a,{className:"pt-2 h-100 d-flex flex-column",onSubmit:function(e){return e.preventDefault()},children:[Object(i.jsxs)(le.a,{className:"mb-1",children:[Object(i.jsx)(le.a.Prepend,{children:Object(i.jsx)(le.a.Text,{children:Object(i.jsx)(me.a,{})})}),Object(i.jsx)(O.a,{type:"text",placeholder:"Filter recipes",value:d,onChange:function(e){f(e.currentTarget.value)}}),Object(i.jsx)(le.a.Append,{children:Object(i.jsx)(le.a.Text,{style:{backgroundColor:"white"},children:Object(i.jsx)(ue.a,{placement:"right",overlay:Object(i.jsx)(he.a,{id:"clear-search-field",children:"Clear search field"}),children:Object(i.jsx)(ve.a,{style:{cursor:"pointer"},onClick:function(){return h("")}})},"download")})})]}),Object(i.jsx)(m.a.Group,{controlId:"recipeGroup",className:"flex-grow-1 overflow-auto mealee-recipe-selector-list",children:Object(i.jsx)(pe.a,{children:w})})]})},Fe=n(196),Le=function(e){var t,n=e.bucketId,r=e.recipeStore,a=e.plannedRecipe,s=e.onDelete,c=e.onUpdate,o=null!==(t=r.get(a.getRecipeId()))&&void 0!==t?t:M.error,l=Object(Ce.a)({item:{type:"recipe",plannedRecipe:a,from:n},collect:function(e){return{isDragging:!!e.isDragging()}}}),u=Object(v.a)(l,2),d=u[0].isDragging,g=u[1],b=new Intl.Collator,f=o.getLabels().sort(b.compare).map((function(e){return Object(i.jsx)(p.a,{sm:"auto",className:"mealee-bucker-recipe-label mt-1 ml-2",children:e},e)}));return Object(i.jsxs)("div",{ref:g,className:"hover",style:{position:"relative",width:"100%",height:"100%",opacity:d?.5:1,cursor:"move"},children:[Object(i.jsx)(je.a,{className:"mealee-bucket-recipe",children:Object(i.jsx)(je.a.Body,{className:"mealee-bucket-recipe-body",children:Object(i.jsxs)(h.a,{children:[Object(i.jsx)(j.a,{children:Object(i.jsx)(p.a,{className:"pl-0 ml-2",children:o.getTitle()})}),Object(i.jsx)(j.a,{children:f})]})})}),Object(i.jsxs)("div",{className:"hover-on",style:{position:"absolute",top:0,right:0,height:40,width:20,zIndex:1,opacity:.5},children:[Object(i.jsx)(I.a,{height:"18",onClick:function(){return s(o.getId())},style:{cursor:"pointer"}}),Object(i.jsx)(ue.a,{placement:"auto",overlay:Object(i.jsxs)(de.a,{id:"popover-recipe-quick-view",className:"recipe-quick-view",children:[Object(i.jsx)(de.a.Title,{as:"h4",children:o.getTitle()}),Object(i.jsx)(de.a.Content,{children:Object(i.jsx)(Ne,{recipe:o})})]}),children:Object(i.jsx)(be.a,{height:"18",style:{cursor:"pointer"}})})]}),Object(i.jsx)("div",{className:"hover-on",style:{position:"absolute",top:0,left:3,height:20,width:25,zIndex:1,opacity:.5},children:Object(i.jsx)(ue.a,{placement:"right",overlay:Object(i.jsx)(he.a,{id:"tooltip-new",children:"Scroll up/down to change"}),children:Object(i.jsxs)("div",{onWheel:function(e){var t=e.deltaY>0?Math.max(1,a.getServing()-1):Math.min(9,a.getServing()+1);c(new K(a.getRecipeId(),t))},children:[Object(i.jsx)("span",{style:{fontSize:12,paddingTop:2,paddingRight:0},children:a.getServing()}),Object(i.jsx)(xe.a,{height:"12"})]})},"new")})]})},Be=function(e){var t=e.bucketId,n=e.recipeStore,r=e.plannedRecipes,a=e.onDelete,s=e.onUpdate;return Object(i.jsxs)(je.a,{className:"mealee-bucket",children:[Object(i.jsx)(je.a.Header,{className:"mealee-bucket-header",children:"Day "+(t+1)}),Object(i.jsx)(je.a.Body,{className:"mealee-bucket-body",children:r.map((function(e){return Object(i.jsx)(Le,{bucketId:t,recipeStore:n,plannedRecipe:e,onDelete:function(e){return a(t,e)},onUpdate:function(e){return s(t,e)}},e.getRecipeId())}))})]})},De=function(e){var t=e.bucketId,n=e.recipeStore,r=e.plannedRecipes,a=e.onDrop,s=e.onMove,c=e.onDelete,o=e.onUpdate,l=Object(Fe.a)({accept:"recipe",drop:function(e){var i=e;if(void 0!==i.from&&void 0!==i.plannedRecipe)s(i.from,t,i.plannedRecipe);else{var r=n.get(i.id);a(t,new K(i.id,r?r.getServing():0))}},collect:function(e){return{isOver:!!e.isOver()}}}),u=Object(v.a)(l,2),d=u[0].isOver,h=u[1];return Object(i.jsxs)("div",{ref:h,style:{position:"relative",width:"100%",height:"100%"},children:[Object(i.jsx)(Be,{bucketId:t,recipeStore:n,plannedRecipes:r,onDelete:c,onUpdate:o}),d&&Object(i.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",zIndex:1,opacity:.5,backgroundColor:"yellow"}})]})},Te=function(e){var t=e.recipeStore,n=e.plan,r=e.updatePlan,a=function(e,t){r(n.setPlannedRecipe(e,t))},s=function(e,t){r(n.deleteRecipeById(e,t))},c=function(e,t){r(n.setPlannedRecipe(e,t))},o=function(e,t,i){r(n.deleteRecipeById(e,i.getRecipeId()).setPlannedRecipe(t,i))},l=D.a.range(n.getNrBuckets()).map((function(e){return Object(i.jsx)(p.a,{xs:"auto",className:"pr-2 pl-0",children:Object(i.jsx)(De,{bucketId:e,recipeStore:t,plannedRecipes:n.getPlannedRecipes(e),onDrop:a,onDelete:s,onUpdate:c,onMove:o})},e)}));return Object(i.jsx)(h.a,{className:"pt-0 pb-2 pl-0 pr-0",children:Object(i.jsx)(j.a,{children:l})})},Ue=n(117);function Ee(){var e=this;return Object(i.jsxs)(p.a,{xs:"auto",className:"pt-3",children:[Object(i.jsx)(Ue.a,{isOpen:this.state.isInitialTour,onRequestClose:function(){return e.setIsInitialTour(!1)},steps:[{selector:".my-first-step-a",content:Object(i.jsx)(h.a,{className:"pt-4",children:"Load some recipes from a file or ..."})},{selector:".my-first-step-b",content:Object(i.jsx)(h.a,{className:"pt-4",children:"... or add a new recipe manually!"})}]}),Object(i.jsxs)(g.a,{variant:"warning",children:["I do not see any recipes. ",Object(i.jsx)(b.a,{variant:"link",className:"pt-1",onClick:function(){return e.setIsInitialTour(!0)},children:"Are you new to Mealee?"})]},"recipe")]})}function Ae(){return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(p.a,{xs:"8",sm:"5",md:"4",lg:"3",xl:"3",className:"h-100",style:{minHeight:0},children:Object(i.jsx)(Re,{plan:this.state.plan,scoring:this.state.recipeStore.scoreBy(this.state.plan,this.state.settings.getScoringFuns(),this.state.rand),recipeStore:this.state.recipeStore,onEdit:this.editRecipe,highlightedRecipes:this.state.highlightedRecipes})}),Object(i.jsx)(p.a,{children:Object(i.jsxs)(h.a,{className:"pt-2 pl-0 pr-0",children:[Object(i.jsx)(j.a,{children:Object(i.jsx)(p.a,{children:Object(i.jsx)(Te,{recipeStore:this.state.recipeStore,plan:this.state.plan,updatePlan:this.updatePlan})})}),this.state.plan.getNrRecipes()>0&&Object(i.jsx)(j.a,{children:Object(i.jsxs)(p.a,{className:"pl-0",children:[Object(i.jsxs)(b.a,{variant:"mealee",onClick:this.showDialog(Q.SavePlanXLS),children:["Export plan \xa0",Object(i.jsx)(ie.a,{src:"xlsx_logo.svg",height:"18"})]}),Object(i.jsxs)(b.a,{className:"ml-2",variant:"mealee",onClick:this.showDialog(Q.ShoppingList),children:["Show shopping list \xa0",Object(i.jsx)(ie.a,{src:"todoist_logo.svg",height:"18"})]})]})})]})})]})}var Me=function(){function e(t,n,i){Object(o.a)(this,e),this.recipes=void 0,this.settings=void 0,this.lastUpdated=void 0,this.recipes=t,this.settings=n,this.lastUpdated=null!==i&&void 0!==i?i:new Date}return Object(l.a)(e,[{key:"getRecipes",value:function(){return this.recipes}},{key:"getSettings",value:function(){return this.settings}},{key:"getLastUpdated",value:function(){return this.lastUpdated}}]),e}();Me.prototype.serialize=function(){var e=JSON.stringify({fileVersion:1,recipes:this.getRecipes(),settings:this.getSettings(),lastUpdated:this.getLastUpdated().toISOString()}),t=(new TextEncoder).encode(e);return new Blob([t],{type:"application/json;charset=utf-8"})};var Pe=n(185),ze=n(186),Je=n(187),_e=n(188),He=n(189),Ge=function(e){var t=e.wsInfo;return Object(i.jsxs)(h.a,{children:[Object(i.jsxs)(j.a,{children:[Object(i.jsx)(p.a,{xs:6,children:"Last updated:"}),Object(i.jsx)(p.a,{sm:"auto",children:t.lastUpdated?t.lastUpdated.toLocaleString():"-"})]}),Object(i.jsxs)(j.a,{children:[Object(i.jsx)(p.a,{xs:6,children:"Number of recipes:"}),Object(i.jsx)(p.a,{sm:"auto",children:t.nrRecipes})]})]})},qe=function(e){var t=e.onLoadFile,n=e.onNewRecipe,r=e.onSaveFile,a=e.onEditSettings,s=e.unsavedChanges,c=e.wsInfo;return Object(i.jsxs)(h.a,{className:"pl-0 ml-2 mr-2 p-0",children:[Object(i.jsx)(j.a,{className:"mb-4",children:Object(i.jsx)(p.a,{className:"pr-0",children:Object(i.jsx)(ue.a,{placement:"right",overlay:Object(i.jsx)(he.a,{id:"tooltip-upload",children:"Load recipes and settings"}),children:Object(i.jsx)(Pe.a,{className:"my-first-step-a",style:{color:"#ffffff",cursor:"pointer"},onClick:t})},"upload")})}),Object(i.jsx)(j.a,{className:"mb-4",children:Object(i.jsx)(p.a,{className:"pr-0",children:Object(i.jsx)(ue.a,{placement:"right",overlay:Object(i.jsx)(he.a,{id:"tooltip-download",children:"Save recipes and settings"}),children:s?Object(i.jsx)(ze.a,{className:"text-warning",style:{cursor:"pointer"},onClick:r}):Object(i.jsx)(ze.a,{style:{color:"#ffffff40"}})},"download")})}),Object(i.jsx)(j.a,{className:"mb-4",children:Object(i.jsx)(p.a,{className:"pr-0",children:Object(i.jsx)(ue.a,{placement:"right",overlay:Object(i.jsx)(he.a,{id:"tooltip-new",children:"Add new recipe"}),children:Object(i.jsx)(Je.a,{className:"my-first-step-b",style:{color:"#ffffff",cursor:"pointer"},onClick:n})},"new")})}),Object(i.jsx)(j.a,{className:"mb-4",children:Object(i.jsx)(p.a,{className:"pr-0",children:Object(i.jsx)(ue.a,{placement:"right",overlay:Object(i.jsxs)(de.a,{id:"popover-info",className:"quick-info",children:[Object(i.jsx)(de.a.Title,{children:"Recipes information"}),Object(i.jsx)(de.a.Content,{children:Object(i.jsx)(Ge,{wsInfo:c})})]}),children:Object(i.jsx)(_e.a,{style:{color:"#ffffff",cursor:"pointer"}})},"info")})}),Object(i.jsx)(j.a,{className:"mb-4",children:Object(i.jsx)(p.a,{className:"pr-0",children:Object(i.jsx)(ue.a,{placement:"right",overlay:Object(i.jsx)(he.a,{id:"tooltip-settings",children:"Settings"}),children:Object(i.jsx)(He.a,{style:{color:"#ffffff",cursor:"pointer"},onClick:a})},"settings")})})]})},We=n(194),Ve=n(106);var Xe,Ke=function(){return Object(i.jsxs)(We.a,{bg:"mealee-menu",variant:"dark",className:"pl-1",children:[Object(i.jsx)(We.a.Brand,{className:"logo mr-2",href:"#home",children:Object(i.jsx)(ie.a,{src:"mealee_logo_v9.svg",height:60,alt:"Mealee"})}),Object(i.jsx)(We.a.Brand,{style:{marginTop:40},children:Object(i.jsx)("span",{style:{fontFamily:"'Baloo 2', cursive",fontWeight:500,fontSize:30},children:"meal planning for geeks"})}),Object(i.jsx)(We.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(i.jsx)(We.a.Collapse,{id:"basic-navbar-nav",children:Object(i.jsx)(Ve.a,{className:"container-fluid",children:Object(i.jsx)(Ve.a.Item,{className:"ml-auto",children:Object(i.jsxs)("span",{style:{fontFamily:"'Baloo 2', cursive",fontWeight:600,fontSize:20,color:"#D1EdF230"},children:["v","".concat("0.5.13")]})})})})]})},Ye=n(122),Qe=n(59);n(155);!function(e){e[e.LoadFile=0]="LoadFile",e[e.SaveFile=1]="SaveFile",e[e.RecipeEditor=2]="RecipeEditor",e[e.SavePlanXLS=3]="SavePlanXLS",e[e.ShoppingList=4]="ShoppingList",e[e.PlanSettings=5]="PlanSettings"}(Xe||(Xe={}));var Ze=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var i;Object(o.a)(this,n),(i=t.call(this,e)).renderDialog=ne,i.renderInitialBody=Ee,i.renderDesktopBody=Ae,i.addRecipes=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.setState((function(n){var i=n.unsavedChanges||!(t&&0===n.recipeStore.count()),r=e.reduce((function(e,t){return e.has(t.getId())?e:e.set(t.getId(),Math.random())}),n.rand),a={},s=n.recipeStore.addAll(e);return s!==n.recipeStore&&(a={recipeStore:s,rand:r,highlightedRecipes:i?Object(J.c)(e.map((function(e){return e.getId()}))):Object(J.c)(),unsavedChanges:i}),a}))},i.setIsInitialTour=function(e){i.setState({isInitialTour:e})},i.saveRecipe=function(e){i.addRecipes([e]),i.closeRecipeEditor()},i.onFileLoaded=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;if("string"==typeof n)try{var r=function(e){var t=JSON.parse(e);if("object"===typeof t){var n=t;if(n.fileVersion||(n.fileVersion=1),"undefined"!==typeof n.fileVersion){if(1!==n.fileVersion)throw new Error("Invalid recipe file version");var i=n.lastUpdated?new Date(Date.parse(n.lastUpdated)):void 0;if(Array.isArray(n.recipes))return new Me(n.recipes.map(M.fromJSON),n.settings?L.fromJSON(n.settings):new L,i)}}throw new Error("Invalid mealee file")}(n);i.addRecipes(r.getRecipes(),!0),i.updateSettings(r.getSettings(),!0),i.setState({lastUpdated:r.getLastUpdated()})}catch(a){i.setState({error:a.message})}i.closeDialog()},i.loadFile=function(e){var t=new FileReader;t.onload=function(e){return i.onFileLoaded(e)},t.readAsText(e,"UTF-8")},i.genRecipeFileContent=function(){return new Me(i.state.recipeStore.all(),i.state.settings).serialize()},i.fileSaved=function(){i.setState({unsavedChanges:!1,lastUpdated:new Date}),i.closeDialog()},i.showDialog=function(e){return function(){return i.setState({showDialog:e})}},i.closeDialog=function(){i.setState({showDialog:void 0})},i.closeRecipeEditor=function(){i.setState({recipeToEdit:void 0,showDialog:void 0})},i.dismissError=function(){i.setState({error:null})},i.updateSettings=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.setState((function(n){return{settings:e,unsavedChanges:!t,plan:n.plan.setNrBuckets(e.getNrBuckets()),showDialog:void 0}}))},i.updatePlan=function(e){i.setState({plan:e})},i.editRecipe=function(e){i.setState({showDialog:Xe.RecipeEditor,recipeToEdit:e})},i.deleteRecipe=function(e){i.setState((function(t){return{recipeStore:t.recipeStore.delete(e.getId()),showDialog:void 0,recipeToEdit:void 0,unsavedChanges:!0}}))};var r=new _,a=new L,s=Y.new(a.getNrBuckets());return i.state={recipeStore:r,settings:a,plan:s,showDialog:void 0,recipeToEdit:void 0,error:null,unsavedChanges:!1,isInitialTour:!1,rand:Object(J.b)(),highlightedRecipes:Object(J.c)()},i}return Object(l.a)(n,[{key:"render",value:function(){return Object(i.jsxs)(h.a,{fluid:!0,className:"d-flex flex-column vh-100",children:[Object(i.jsx)(g.a,{variant:"danger",onClose:this.dismissError,show:!!this.state.error,dismissible:!0,children:this.state.error}),this.state.unsavedChanges&&Object(i.jsx)(Ye.a,{onBeforeunload:function(){return"You'll lose your data!"}}),this.renderDialog(),Object(i.jsx)(j.a,{children:Object(i.jsx)(p.a,{children:Object(i.jsx)(Ke,{})})}),Qe.isMobileOnly?Object(i.jsx)(j.a,{children:Object(i.jsx)(p.a,{className:"mt-3",children:Object(i.jsx)(g.a,{variant:"danger",children:"Mobile is not supported as for now. Please try it on a little bit bigger device. Sorry for that."},"recipe")})}):Object(i.jsxs)(j.a,{className:"h-100",style:{minHeight:0},children:[Object(i.jsx)(p.a,{xs:"auto",className:"pl-0 pr-2 pt-3",children:Object(i.jsx)(qe,{onLoadFile:this.showDialog(Xe.LoadFile),onNewRecipe:this.showDialog(Xe.RecipeEditor),onSaveFile:this.showDialog(Xe.SaveFile),onEditSettings:this.showDialog(Xe.PlanSettings),unsavedChanges:this.state.unsavedChanges,wsInfo:{lastUpdated:this.state.lastUpdated,nrRecipes:this.state.recipeStore.count()}})}),0===this.state.recipeStore.count()&&this.renderInitialBody(),this.state.recipeStore.count()>0&&!Qe.isMobileOnly&&this.renderDesktopBody()]})]})}}]),n}(a.a.Component),$e=n(95),et=n(13),tt=n(116),nt=n(115),it=n.n(nt),rt=n(190),at=n(119),st=n(120);$e.a.initialize("UA-74643376-3"),$e.a.pageview("/");var ct=function(){var e=Object(et.g)();return console.log("state"),console.log(e.state),Object(i.jsx)(rt.a,{backend:Qe.isMobile?st.a:at.a,children:Object(i.jsx)(Ze,{})})},ot=function(){var e=new URLSearchParams(Object(et.g)().search);return Object(i.jsx)(et.a,{to:{pathname:"/",state:{callback:"google-signin",token:e.get("token")}}})};c.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(it.a,{children:Object(i.jsx)(tt.a,{children:Object(i.jsxs)(et.d,{children:[Object(i.jsx)(et.b,{exact:!0,path:"/",children:Object(i.jsx)(ct,{})}),Object(i.jsx)(et.b,{path:"/google-signin",children:Object(i.jsx)(ot,{})})]})})})}),document.getElementById("root"))}},[[156,1,2]]]);
//# sourceMappingURL=main.6d78d0e4.chunk.js.map