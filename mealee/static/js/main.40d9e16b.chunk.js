(this.webpackJsonpmealee=this.webpackJsonpmealee||[]).push([[0],{116:function(e,t,a){e.exports=a(150)},117:function(e,t,a){},135:function(e,t){},136:function(e,t){},150:function(e,t,a){"use strict";a.r(t);a(117);var n=a(0),r=a.n(n),i=a(14),l=a.n(i),o=a(12),c=a(21),s=a(109),u=a(107),m=a(159),d=a(160),p=a(93),f=a(171),h=a(158),g=a(178),v=a(179),E=function(){function e(t){Object(o.a)(this,e),this.db=void 0,this.db=t}return Object(c.a)(e,[{key:"getIngredients",value:function(){var e=new Set;this.db.all().forEach((function(t){t.getIngredients().forEach((function(t){e.add(t.getName().toLowerCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)}},{key:"getUnits",value:function(){var e=new Set;this.db.all().forEach((function(t){t.getIngredients().forEach((function(t){e.add(t.getUnit().toLowerCase())}))}));var t=new Intl.Collator;return Array.from(e).sort(t.compare)}}]),e}(),y=a(10),b=a(92),I=function(e){var t=e.title,a=e.loadButtonTitle,n=e.onClose,i=e.onLoad,l=r.a.useState(null),o=Object(y.a)(l,2),c=o[0],s=o[1];return r.a.createElement(g.a,{show:!0,onHide:n},r.a.createElement(g.a.Header,{closeButton:!0},r.a.createElement(g.a.Title,null,t)),r.a.createElement(g.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(b.a,{type:"file",onChange:function(e){e.target.files?s(e.target.files[0]):s(null)}}))),r.a.createElement(g.a.Footer,null,r.a.createElement(h.a,{type:"button",variant:"secondary",onClick:n},"Close"),r.a.createElement(h.a,{type:"button",variant:"primary",disabled:!c,onClick:function(){c&&i(c)}},a)))},S=a(94),k=a.n(S),w=function(e){var t=e.title,a=e.saveButtonTitle,n=e.onClose,i=e.onSave,l=e.data,o=e.type,c=e.initialFileName,s=e.extension,u=r.a.useState(c),m=Object(y.a)(u,2),d=m[0],p=m[1];return r.a.createElement(g.a,{show:!0,onHide:n},r.a.createElement(g.a.Header,{closeButton:!0},r.a.createElement(g.a.Title,null,t)),r.a.createElement(g.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(v.a.Group,{controlId:"formBasicFileName"},r.a.createElement(v.a.Label,null,"File name"),r.a.createElement(v.a.Control,{type:"fileName",value:d,onChange:function(e){return p(e.target.value)}})))),r.a.createElement(g.a.Footer,null,r.a.createElement(h.a,{type:"button",variant:"secondary",onClick:n},"Close"),r.a.createElement(h.a,{type:"button",variant:"primary",disabled:!d||0===d.length,onClick:function(){k()(l,d+"."+s,o),i()}},a)))};var x=a(15);var N=function e(){Object(o.a)(this,e),this.name="Minimal number of ingredients",this.id="miningredients",this.filter=function(e,t,a){var n=new Set(e.concat(t).flatMap((function(e){return e.getIngredients().map((function(e){return e.getName()}))}))),r=a.map((function(e){return{recipe:e,score:(t=n,a=e,a.getIngredients().reduce((function(e,a){return t.has(a.getName())?e:e+1}),0))};var t,a})).sort((function(e,t){return e.score<t.score?-1:e.score>t.score?1:0})),i=[];if(r.length>0){var l,o=Object(x.a)(r);try{for(o.s();!(l=o.n()).done;){var c=l.value;if(r[0].score!==c.score)break;i.push(c.recipe)}}catch(s){o.e(s)}finally{o.f()}}return i}};var C=function e(){Object(o.a)(this,e),this.name="Maximal reuse of ingredients",this.id="maxreuse",this.filter=function(e,t,a){var n=new Set(e.concat(t).flatMap((function(e){return e.getIngredients().map((function(e){return e.getName()}))}))),r=a.map((function(e){return{recipe:e,score:(t=n,a=e,a.getIngredients().reduce((function(e,a){return t.has(a.getName())?e+1:e}),0))};var t,a})).sort((function(e,t){return e.score<t.score?1:e.score>t.score?-1:0})),i=[];if(r.length>0){var l,o=Object(x.a)(r);try{for(o.s();!(l=o.n()).done;){var c=l.value;if(r[0].score!==c.score)break;i.push(c.recipe)}}catch(s){o.e(s)}finally{o.f()}}return i}},O=new function e(){Object(o.a)(this,e),this.name="Random filter",this.id="rnd",this.filter=function(e,t,a){return 0===a.length?[]:[a[(n=a.length,Math.floor(Math.random()*Math.floor(n)))]];var n}};var j=function(){var e=[new N,new C,O],t=new Map(e.map((function(e){return[e.id,e]})));return{all:function(){return e},get:function(e){return t.get(e)}}}(),R=function(e){var t=j.all().map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}));return r.a.createElement(g.a,{show:!0,onHide:e.onClose},r.a.createElement(g.a.Header,{closeButton:!0},r.a.createElement(g.a.Title,null,"Plan settings")),r.a.createElement(g.a.Body,null,r.a.createElement(v.a,{onSubmit:function(e){return e.preventDefault()}},r.a.createElement(v.a.Group,{controlId:"nrRecipes"},r.a.createElement(v.a.Label,null,"Number of recipes:"),r.a.createElement(v.a.Control,{as:"select",value:e.planSettings.nrRecipes,onChange:function(t){return function(t){var a=e.planSettings.clone();a.nrRecipes=t,e.onUpdate(a)}(parseInt(t.target.value))}},r.a.createElement("option",{key:"3"},"3"),r.a.createElement("option",{key:"4"},"4"),r.a.createElement("option",{key:"5"},"5"),r.a.createElement("option",{key:"6"},"6"),r.a.createElement("option",{key:"7"},"7"))),r.a.createElement(v.a.Group,{controlId:"optimization"},r.a.createElement(v.a.Label,null,"Optimize by:"),r.a.createElement(v.a.Control,{as:"select",value:e.planSettings.optimization.id,onChange:function(t){return function(t){var a=j.get(t);if(a){var n=e.planSettings.clone();n.optimization=a,e.onUpdate(n)}}(t.target.value)}},t)))),r.a.createElement(g.a.Footer,null,r.a.createElement(h.a,{type:"button",variant:"secondary",onClick:e.onClose},"Close")))},M=a(18),L=function(){function e(t,a,n){Object(o.a)(this,e),this.name=void 0,this.amount=void 0,this.unit=void 0,this.name=t,this.amount=a,this.unit=n}return Object(c.a)(e,[{key:"getName",value:function(){return this.name}},{key:"getAmount",value:function(){return this.amount}},{key:"getUnit",value:function(){return this.unit}},{key:"toJSON",value:function(){return{name:this.name,amount:this.amount,unit:this.unit}}}],[{key:"fromJSON",value:function(t){if(!t.name)throw new Error("Missing ingredient name");if(!t.unit)throw new Error("Missing ingredient unit");if(void 0===t.amount)throw new Error("Missing ingredient amount");return new e(t.name,t.amount,t.unit)}}]),e}();var F=function(){function e(t,a){Object(o.a)(this,e),this.id=void 0,this.title=void 0,this.comment=void 0,this.source=void 0,this.readyInMinutes=void 0,this.ingredients=void 0,this.labels=void 0,this.id=t,this.title=a,this.ingredients=[],this.labels=[]}return Object(c.a)(e,[{key:"getId",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getComment",value:function(){return this.comment}},{key:"getSource",value:function(){return this.source}},{key:"getReadyInMinutes",value:function(){return this.readyInMinutes}},{key:"getIngredients",value:function(){return this.ingredients}},{key:"getLabels",value:function(){return this.labels}},{key:"toJSON",value:function(){return{id:this.id,title:this.title,comment:this.comment,source:this.source,readyInMinutes:this.readyInMinutes,ingredients:this.ingredients.map((function(e){return e.toJSON()})),labels:this.labels}}}],[{key:"fromJSON",value:function(t){var a;if(t.id||(t.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))),!t.title)throw new Error("Missing recipe title");var n=new e(t.id,t.title);return n.comment=t.comment,n.source=t.source,n.readyInMinutes=t.readyInMinutes,n.labels=null!==(a=t.labels)&&void 0!==a?a:[],Array.isArray(t.ingredients)&&(n.ingredients=t.ingredients.map((function(e){return L.fromJSON(e)}))),n}}]),e}();var T=a(13),D=a.n(T);a(125),a(126),a(127),a(128),a(79),a(129),a(130);function A(e,t){for(var a=[],n=e.split(/\r?\n/),r=0;r<n.length;r++){var i=n[r];if(i.trim().length>0){var l=i.split(";");if(l.length<3)t.push({from:D.a.Pos(r,0),to:D.a.Pos(r,i.length),message:"Not enough parts. Syntax: <name>;<amount>;<unit>"});else if(l.length>3){var o=l[0].length+l[1].length+l[2].length+2;t.push({from:D.a.Pos(r,o),to:D.a.Pos(r,i.length),message:"Too many parts. Syntax: <name>;<amount>;<unit>"})}else{var c=l[0].length+1,s=c+l[1].length;0===(l=l.map((function(e){return e.trim()})))[0].length||0===l[1].length||0===l[2].length?t.push({from:D.a.Pos(r,0),to:D.a.Pos(r,i.length),message:"Empty part(s). Syntax: <name>;<amount>;<unit>"}):""+Number.parseFloat(l[1])!==l[1]?t.push({from:D.a.Pos(r,c),to:D.a.Pos(r,s),message:"Amount should be a number."}):a.push({name:l[0],amount:Number.parseFloat(l[1]),unit:l[2]})}}}return a}function B(e,t){return function(a){var n=a.getCursor(),r=a.getLine(n.line),i=n.ch,l=n.ch,o=(r.substring(0,l).match(/;/g)||[]).length;if(0!==o&&2!==o)return null;for(;i&&";"!==r.charAt(i-1);)--i;for(;l<r.length&&";"!==r.charAt(l);)++l;var c=r.slice(i,l).trimLeft().toLowerCase(),s=0===o?e.filter((function(e){return e.indexOf(c)>=0})):t.filter((function(e){return e.startsWith(c)}));return 1===s.length&&s[0]===c&&(s=[]),{list:s,from:D.a.Pos(n.line,i),to:D.a.Pos(n.line,l)}}}D.a.defineMode("ingredients",(function(){var e=0,t=1,a=2,n=3;return{startState:function(){return{location:e}},token:function(r,i){r.sol()&&(i.location=e);var l=r.next();return";"===l&&(i.location===e?i.location=t:i.location===t?i.location=a:i.location=n),i.location===n?"error":";"===l?"keyword":i.location===e?(r.eatWhile((function(e){return";"!==e})),"atom"):i.location===t?(r.eatWhile((function(e){return";"!==e})),"number"):i.location===a?(r.eatWhile((function(e){return";"!==e})),"atom"):"error"}}})),D.a.registerHelper("lint","ingredients",(function(e){var t=[];return A(e,t),t}));var P,z=function(e){var t=r.a.useState(e.recipe?e.recipe.toJSON():Object.create({})),a=Object(y.a)(t,2),n=a[0],i=a[1],l=r.a.useState(!e.recipe),o=Object(y.a)(l,2),c=o[0],s=o[1],u=r.a.useState(!1),m=Object(y.a)(u,2),d=m[0],p=m[1],f=r.a.useState(e.recipe?e.recipe.getIngredients().map((function(e){return e.getName()+";"+e.getAmount()+";"+e.getUnit()})).join("\n"):""),E=Object(y.a)(f,2),b=E[0],I=E[1],S=r.a.useState(e.recipe?e.recipe.getLabels().map((function(e){return e.toUpperCase()})).join(", "):""),k=Object(y.a)(S,2),w=k[0],x=k[1],N=r.a.createRef(),C=r.a.createRef();return r.a.createElement(g.a,{show:!0,onHide:e.onClose,onEntered:function(){if(N.current&&N.current.focus(),C.current){var t=D.a.fromTextArea(C.current,{lineNumbers:!1,mode:"ingredients",gutters:["CodeMirror-lint-markers"],lint:!0,extraKeys:{"Ctrl-Space":"autocomplete"}});t.on("change",(function(e){!function(e){I(e);var t=[],a=A(e,t);t.length>0?p(!0):(p(!1),i((function(e){return Object(M.a)(Object(M.a)({},e),{ingredients:a})})))}(e.getValue())})),t.on("cursorActivity",(function(t){t.showHint({hint:B(e.recipeService.getIngredients(),e.recipeService.getUnits()),completeSingle:!1,closeOnUnfocus:!0})}))}}},r.a.createElement(g.a.Header,{closeButton:!0},r.a.createElement(g.a.Title,null,e.recipe?"Edit":"Add new "," recipe")),r.a.createElement(g.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(v.a.Group,{controlId:"formTitle"},r.a.createElement(v.a.Control,{type:"title",value:n.title,placeholder:"Title",isInvalid:c,onChange:function(e){var t=e.currentTarget.value;s(!t||0===t.length),i((function(e){return Object(M.a)(Object(M.a)({},e),{title:t})}))},ref:N,size:"sm"}),r.a.createElement(v.a.Control.Feedback,{type:"invalid"},"Required field!")),r.a.createElement(v.a.Group,{controlId:"formComment"},r.a.createElement(v.a.Control,{as:"textarea",value:n.comment,onChange:function(e){var t=e.currentTarget.value;i((function(e){return Object(M.a)(Object(M.a)({},e),{comment:t})}))},rows:2,placeholder:"Comment",size:"sm"})),r.a.createElement(v.a.Group,{controlId:"formSource"},r.a.createElement(v.a.Control,{type:"source",value:n.source,onChange:function(e){var t=e.currentTarget.value;i((function(e){return Object(M.a)(Object(M.a)({},e),{source:t})}))},placeholder:"Where to find the recipe",size:"sm"})),r.a.createElement(v.a.Group,{controlId:"formMinutes"},r.a.createElement(v.a.Control,{type:"minutes",value:n.readyInMinutes,onChange:function(e){var t=Number.parseInt(e.currentTarget.value);isNaN(t)&&(t=void 0),i((function(e){return Object(M.a)(Object(M.a)({},e),{readyInMinutes:t})}))},placeholder:"Number of minutes to cook",size:"sm"})),r.a.createElement(v.a.Group,{controlId:"formLabels"},r.a.createElement(v.a.Control,{type:"labels",value:w,onChange:function(e){var t=e.currentTarget.value.toUpperCase();x(t);var a=t.split(",").map((function(e){return e.trim()}));i((function(e){return Object(M.a)(Object(M.a)({},e),{labels:a})}))},placeholder:"Labels: LABEL1, LABEL2, ...",size:"sm"})),r.a.createElement(v.a.Group,{controlId:"formIngredients"},r.a.createElement(v.a.Control,{as:"textarea",value:b,ref:C,placeholder:"Ingredients: <name>;<amount>;<unit>"})))),r.a.createElement(g.a.Footer,null,r.a.createElement(h.a,{type:"button",variant:"secondary",onClick:e.onClose},"Close"),r.a.createElement(h.a,{type:"button",variant:"primary",onClick:function(){e.onSave(F.fromJSON(n))},disabled:c||d},"Save recipe"),e.recipe&&r.a.createElement(h.a,{type:"button",variant:"primary",onClick:function(){e.recipe&&e.onDelete(e.recipe)}},"Delete recipe")))},_=a(24),H=a.n(_),J=a(38),U=a.n(J);function G(e){var t=new Map;return e.forEach((function(e){e.getIngredients().forEach((function(a){var n,r=a.getName().toLowerCase(),i=t.get(r);i||(i=new Map,t.set(r,i));var l=null!==(n=i.get(e.getId()))&&void 0!==n?n:[];l.push([a.getAmount(),a.getUnit().toLowerCase()]),i.set(e.getId(),l)}))})),t}function X(e,t){var a,n=t.map((function(t){var a,n,r=new Map,i=null!==(a=e.get(t))&&void 0!==a?a:new Map,l=Object(x.a)(i.values());try{for(l.s();!(n=l.n()).done;){var o,c=n.value,s=Object(x.a)(c);try{for(s.s();!(o=s.n()).done;){var u,m=Object(y.a)(o.value,2),d=m[0],p=m[1];r.set(p,(null!==(u=r.get(p))&&void 0!==u?u:0)+d)}}catch(f){s.e(f)}finally{s.f()}}}catch(f){l.e(f)}finally{l.f()}return{name:t,amounts:r}})),r=[],i=Object(x.a)(n);try{for(i.s();!(a=i.n()).done;){var l,o=a.value,c=o.name,s=o.amounts,u=[c],m=Object(x.a)(s);try{for(m.s();!(l=m.n()).done;){var d=Object(y.a)(l.value,2),p=d[0],f=d[1];u.push(f+" "+p)}}catch(h){m.e(h)}finally{m.f()}r.push(u)}}catch(h){i.e(h)}finally{i.f()}return r}function W(e,t){var a,n=G(e.getAll(t.getAllRecipeIds(!1))),r=new Intl.Collator,i=Array.from(n.keys()).sort(r.compare),l=X(n,i),o="",c=Object(x.a)(l);try{for(c.s();!(a=c.n()).done;){var s=a.value;o+="**"+s.shift()+"**",o+=" - ",o+=s.join(" + "),o+="\n"}}catch(u){c.e(u)}finally{c.f()}return o}function q(e,t){var a=e.getAll(t.getAllRecipeIds(!1)),n=new Set(a),r=G(a),i=Array.from(r.keys()).sort(),l=H.a.utils.book_new(),o=U.a.range(0,t.getNrBuckets()).map((function(a){return["Day #"+(a+1)].concat(e.getAll(t.getRecipeIds(a)).map((function(e){return e.getTitle()})))})),c=H.a.utils.aoa_to_sheet(o);H.a.utils.book_append_sheet(l,c,"Plan");var s=X(r,i),u=H.a.utils.aoa_to_sheet(s);H.a.utils.book_append_sheet(l,u,"Shopping list");var m=a.map((function(e){return e.getTitle()}));m.unshift("");var d=i.map((function(e){var t,n=[e],i=Object(x.a)(a);try{for(i.s();!(t=i.n()).done;){var l,o=t.value,c=(null!==(l=r.get(e))&&void 0!==l?l:new Map).get(o.getId());c?n.push(c.map((function(e){return e[0]+" "+e[1]})).join(", ")):n.push("")}}catch(s){i.e(s)}finally{i.f()}return n})),p=[m].concat(d),f=H.a.utils.aoa_to_sheet(p);H.a.utils.book_append_sheet(l,f,"Ingredient map");var h,g=Object(x.a)(n);try{for(g.s();!(h=g.n()).done;){var v,E,y,b,I=h.value,S=[["Title",I.getTitle()],["Comment",null!==(v=I.getComment())&&void 0!==v?v:"-"],["Ready in minutes",null!==(E=I.getReadyInMinutes())&&void 0!==E?E:"-"],["Source",null!==(y=I.getSource())&&void 0!==y?y:"-"],["Ingredients:"]],k=Object(x.a)(I.getIngredients());try{for(k.s();!(b=k.n()).done;){var w=b.value;S.push([w.getName().toLowerCase(),w.getAmount(),w.getUnit().toLowerCase()])}}catch(O){k.e(O)}finally{k.f()}var N=H.a.utils.aoa_to_sheet(S);H.a.utils.book_append_sheet(l,N,I.getTitle().substr(0,31))}}catch(O){g.e(O)}finally{g.f()}var C=H.a.write(l,{bookType:"xlsx",bookSST:!1,type:"array"});return new Blob([C],{type:"application/octet-stream"})}function K(){switch(this.state.showDialog){case P.LoadFile:return r.a.createElement(I,{onClose:this.closeDialog,title:"Load recipes file",loadButtonTitle:"Load recipes",onLoad:this.loadFile});case P.SaveFile:return r.a.createElement(w,{onClose:this.closeDialog,title:"Save recipes file",saveButtonTitle:"Save recipes",data:this.genRecipeFileContent(),type:"application/json",initialFileName:"recipes",extension:"json",onSave:this.fileSaved});case P.RecipeEditor:return r.a.createElement(z,{onClose:this.closeRecipeEditor,onSave:this.saveRecipe,onDelete:this.deleteRecipe,recipe:this.state.recipeToEdit,recipeService:new E(this.state.recipeIndex)});case P.SavePlanXLS:return r.a.createElement(w,{onClose:this.closeDialog,title:"Save plan",saveButtonTitle:"Save plan",data:q(this.state.recipeIndex,this.state.plan2),type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",initialFileName:"plan",extension:"xlsx",onSave:this.closeDialog});case P.ShoppingList:return r.a.createElement(g.a,{show:!0,onHide:this.closeDialog},r.a.createElement(g.a.Header,{closeButton:!0},r.a.createElement(g.a.Title,null,"Shopping list")),r.a.createElement(g.a.Body,null,r.a.createElement(v.a,null,r.a.createElement(v.a.Control,{as:"textarea",rows:20,cols:80,value:W(this.state.recipeIndex,this.state.plan2),readOnly:!0}))),r.a.createElement(g.a.Footer,null,r.a.createElement(h.a,{variant:"secondary",onClick:this.closeDialog},"Close")));case P.PlanSettings:return r.a.createElement(R,{onClose:this.closeDialog,planSettings:this.state.planSettings,onUpdate:this.updatePlanSettings});default:return r.a.createElement(r.a.Fragment,null)}}!function(e){e[e.LoadFile=0]="LoadFile",e[e.SaveFile=1]="SaveFile",e[e.RecipeEditor=2]="RecipeEditor",e[e.SavePlanXLS=3]="SavePlanXLS",e[e.ShoppingList=4]="ShoppingList",e[e.PlanSettings=5]="PlanSettings"}(P||(P={}));var Y=a(172),V=a(168),Q=a(180),Z=a(184),$=a(186),ee=a(187),te=a(166),ae=a(167),ne=a(169),re=(a(138),a(95)),ie=a(161),le=a(162),oe=a(163),ce=a(164),se=a(165),ue=function(e){var t=e.recipe,a=new Intl.Collator,n=t.getIngredients().map((function(e){return e.getName()})).sort(a.compare).map((function(e){return r.a.createElement(p.a,{key:e,sm:"auto",className:"border mt-1 ml-2 pt-2 pb-2"},e)})),i=t.getLabels().sort(a.compare).map((function(e){return r.a.createElement(p.a,{key:e,sm:"auto",className:"border mt-1 ml-2 pt-2 pb-2"},e)}));return r.a.createElement(m.a,{className:"pl-0 pr-2"},t.getComment()&&r.a.createElement(d.a,{className:"pb-2"},r.a.createElement(p.a,{sm:"auto"},r.a.createElement(ie.a,{height:"18"})),r.a.createElement(p.a,{sm:"auto"},t.getComment())),t.getReadyInMinutes()&&r.a.createElement(d.a,{className:"pb-2"},r.a.createElement(p.a,{sm:"auto"},r.a.createElement(le.a,{height:"18"})),r.a.createElement(p.a,{sm:"auto"},t.getReadyInMinutes()+" minutes")),t.getSource()&&r.a.createElement(d.a,{className:"pb-2"},r.a.createElement(p.a,{sm:"auto"},r.a.createElement(oe.a,{height:"18"})),r.a.createElement(p.a,{sm:"auto"},t.getSource())),r.a.createElement(d.a,null,r.a.createElement(p.a,{xs:1},r.a.createElement(ce.a,{height:"18"})),r.a.createElement(p.a,null,r.a.createElement(m.a,{fluid:!0,className:"pl-0"},r.a.createElement(d.a,null,n)))),t.getLabels().length>0&&r.a.createElement(d.a,null,r.a.createElement(p.a,{xs:1},r.a.createElement(se.a,{height:"18"})),r.a.createElement(p.a,null,r.a.createElement(m.a,{fluid:!0,className:"pl-0"},r.a.createElement(d.a,null,i)))))},me=a(182),de=function(e){var t=e.recipe,a=e.selected,n=e.onEdit,i=Object(me.a)({item:{type:"recipe",id:t.getId()},collect:function(e){return{isDragging:!!e.isDragging()}}}),l=Object(y.a)(i,2),o=l[0].isDragging,c=l[1],s=new Intl.Collator,u=t.getLabels().sort(s.compare).map((function(e){return r.a.createElement(p.a,{key:e,sm:"auto",className:"mealee-recipe-selector-label mt-1 ml-2"},e)}));return r.a.createElement("div",{className:"hover",style:{position:"relative",width:"100%",height:"100%",backgroundColor:"#FFFFFF"}},r.a.createElement($.a,{className:"mealee-recipe-selector-item",key:t.getId(),ref:c,style:{opacity:o||a?.5:1,cursor:"move"}},r.a.createElement($.a.Body,{className:"p-0"},r.a.createElement(m.a,null,r.a.createElement(d.a,null,r.a.createElement(p.a,{className:"pl-0 ml-2"},t.getTitle())),r.a.createElement(d.a,null,u)))),r.a.createElement("div",{className:"hover-on",style:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:10,height:20,width:40,zIndex:1,opacity:.5}},r.a.createElement(te.a,{height:"18",onClick:function(){return n(t)},style:{cursor:"pointer"}}),"\xa0",r.a.createElement(Q.a,{placement:"auto",overlay:r.a.createElement(Z.a,{id:"popover-basic"},r.a.createElement(Z.a.Title,{as:"h4"},t.getTitle()),r.a.createElement(Z.a.Content,null,r.a.createElement(ue,{recipe:t})))},r.a.createElement(ae.a,{height:"18",style:{cursor:"pointer"}}))))},pe=function(e){var t=e.recipeIndex,a=e.plan,n=e.onEdit,i=r.a.useState(""),l=Object(y.a)(i,2),o=l[0],c=l[1],s=0===o.trim().length?t.all():t.search(o).map((function(e){return e.key})),u=new Set(a.getAllRecipeIds()),m=s.map((function(e){return r.a.createElement(ee.a.Item,{className:"p-0"},r.a.createElement(de,{key:e.getId(),recipe:e,onEdit:n,selected:u.has(e.getId())}))}));return r.a.createElement(v.a,{className:"pt-2 h-100 d-flex flex-column",onSubmit:function(e){return e.preventDefault()}},r.a.createElement(V.a,{className:"mb-1"},r.a.createElement(V.a.Prepend,null,r.a.createElement(V.a.Text,{id:"basic-addon1"},r.a.createElement(ne.a,null))),r.a.createElement(b.a,{type:"text",placeholder:"Filter recipes",onChange:function(e){c(e.currentTarget.value)}})),r.a.createElement(v.a.Group,{controlId:"recipeGroup",className:"flex-grow-1 overflow-auto mealee-recipe-selector-list"},r.a.createElement(ee.a,null,m)))},fe=function(e){var t=e.recipeIndex,a=e.plan,n=e.onEdit,i=r.a.useState(""),l=Object(y.a)(i,2),o=l[0],c=l[1],s=0===o.trim().length?t.all():t.search(o).map((function(e){return e.key})),u=new Set(a.getAllRecipeIds()),m=s.map((function(e){return r.a.createElement(de,{key:e.getId(),recipe:e,onEdit:n,selected:u.has(e.getId())})}));return r.a.createElement(v.a,{className:"pt-2",onSubmit:function(e){return e.preventDefault()}},r.a.createElement(V.a,{className:"mb-1"},r.a.createElement(V.a.Prepend,null,r.a.createElement(V.a.Text,{id:"basic-addon1"},r.a.createElement(ne.a,null))),r.a.createElement(b.a,{type:"text",placeholder:"Filter recipes",onChange:function(e){c(e.currentTarget.value)}})),r.a.createElement("div",{style:{minHeight:150}},r.a.createElement(re.Carousel,{showIndicators:!1,showThumbs:!1,showArrows:!1,useKeyboardArrows:!1,infiniteLoop:!0},m)))},he=a(170),ge=a(183),ve=function(e){var t=e.bucketId,a=e.recipe,n=e.onDelete,i=Object(me.a)({item:{type:"recipe",id:a.getId(),from:t},collect:function(e){return{isDragging:!!e.isDragging()}}}),l=Object(y.a)(i,2),o=l[0].isDragging,c=l[1],s=new Intl.Collator,u=a.getLabels().sort(s.compare).map((function(e){return r.a.createElement(p.a,{key:e,sm:"auto",className:"mealee-bucker-recipe-label mt-1 ml-2"},e)}));return r.a.createElement("div",{ref:c,className:"hover",style:{position:"relative",width:"100%",height:"100%",opacity:o?.5:1,cursor:"move"}},r.a.createElement($.a,{className:"mealee-bucket-recipe"},r.a.createElement($.a.Body,{className:"mealee-bucket-recipe-body"},r.a.createElement(m.a,null,r.a.createElement(d.a,null,r.a.createElement(p.a,{className:"pl-0 ml-2"},a.getTitle())),r.a.createElement(d.a,null,u)))),r.a.createElement("div",{className:"hover-on",style:{position:"absolute",top:0,right:0,height:40,width:20,zIndex:1,opacity:.5}},r.a.createElement(he.a,{height:"18",onClick:function(){return n(a.getId())},style:{cursor:"pointer"}}),r.a.createElement(Q.a,{placement:"auto",overlay:r.a.createElement(Z.a,{id:"popover-basic"},r.a.createElement(Z.a.Title,{as:"h4"},a.getTitle()),r.a.createElement(Z.a.Content,null,r.a.createElement(ue,{recipe:a})))},r.a.createElement(ae.a,{height:"18",style:{cursor:"pointer"}}))))},Ee=function(e){var t=e.bucketId,a=e.recipes,n=e.onDelete;return r.a.createElement($.a,{className:"mealee-bucket"},r.a.createElement($.a.Header,{className:"mealee-bucket-header"},"Day "+(t+1)),r.a.createElement($.a.Body,{className:"mealee-bucket-body"},a.map((function(e){return r.a.createElement(ve,{key:e.getId(),bucketId:t,recipe:e,onDelete:function(e){return n(t,e)}})}))))},ye=function(e){var t=e.bucketId,a=e.recipes,n=e.onDrop,i=e.onMove,l=e.onDelete,o=Object(ge.a)({accept:"recipe",drop:function(e){var a=e;void 0!==a.from?i(a.from,t,a.id):n(t,a.id)},collect:function(e){return{isOver:!!e.isOver()}}}),c=Object(y.a)(o,2),s=c[0].isOver,u=c[1];return r.a.createElement("div",{ref:u,style:{position:"relative",width:"100%",height:"100%"}},r.a.createElement(Ee,{bucketId:t,recipes:a,onDelete:l}),s&&r.a.createElement("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",zIndex:1,opacity:.5,backgroundColor:"yellow"}}))},be=function(e){var t=e.recipeDB,a=e.plan,n=e.updatePlan,i=function(e,t){n(a.addRecipeId(e,t))},l=function(e,t){n(a.deleteRecipeId(e,t))},o=function(e,t,r){n(a.deleteRecipeId(e,r).addRecipeId(t,r))},c=U.a.range(a.getNrBuckets()).map((function(e){return r.a.createElement(p.a,{key:e,xs:"auto",className:"pr-2 pl-0"},r.a.createElement(ye,{bucketId:e,recipes:t.getAll(a.getRecipeIds(e)),onDrop:i,onDelete:l,onMove:o}))}));return r.a.createElement(m.a,{className:"pt-0 pb-2 pl-0 pr-0"},r.a.createElement(d.a,null,c))},Ie=a(104);function Se(){var e=this;return r.a.createElement(p.a,{xs:"auto",className:"pt-3"},r.a.createElement(Ie.a,{isOpen:this.state.isInitialTour,onRequestClose:function(){return e.setIsInitialTour(!1)},steps:[{selector:".my-first-step-a",content:r.a.createElement(m.a,{className:"pt-4"},"Load some recipes from a file or ...")},{selector:".my-first-step-b",content:r.a.createElement(m.a,{className:"pt-4"},"... or add a new recipe manually!")}]}),r.a.createElement(f.a,{key:"recipe",variant:"warning"},"I do not see any recipes. ",r.a.createElement(h.a,{variant:"link",className:"pt-1",onClick:function(){return e.setIsInitialTour(!0)}},"Are you new to Mealee?")))}function ke(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{xs:"8",sm:"5",md:"4",lg:"3",xl:"3",className:"h-100",style:{minHeight:0}},r.a.createElement(pe,{plan:this.state.plan2,recipeIndex:this.state.recipeIndex,onEdit:this.editRecipe})),r.a.createElement(p.a,null,r.a.createElement(m.a,{className:"pt-2 pl-0 pr-0"},r.a.createElement(d.a,null,r.a.createElement(p.a,null,r.a.createElement(be,{recipeDB:this.state.recipeIndex,plan:this.state.plan2,updatePlan:this.updatePlan}))),this.state.plan2.getNrRecipes()>0&&r.a.createElement(d.a,null,r.a.createElement(p.a,{className:"pl-0"},r.a.createElement(h.a,{variant:"mealee",onClick:this.showDialog(P.SavePlanXLS)},"Export plan \xa0",r.a.createElement(Y.a,{src:"xlsx_logo.svg",height:"18"})),r.a.createElement(h.a,{className:"ml-2",variant:"mealee",onClick:this.showDialog(P.ShoppingList)},"Show shopping list \xa0",r.a.createElement(Y.a,{src:"todoist_logo.svg",height:"18"})))))))}function we(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{xs:"10"},r.a.createElement(fe,{plan:this.state.plan2,recipeIndex:this.state.recipeIndex,onEdit:this.editRecipe})))}var xe,Ne=a(41),Ce=a(103),Oe=a(27),je=function e(t,a){var n=this;Object(o.a)(this,e),this.recipesMap=void 0,this.index=void 0,this.fieldAccessors=[function(e){return e.getTitle()},function(e){var t;return null!==(t=e.getComment())&&void 0!==t?t:""},function(e){var t;return null!==(t=e.getSource())&&void 0!==t?t:""},function(e){return e.getIngredients().map((function(e){return e.getName()})).join(" ")},function(e){return e.getLabels().join(" ")}],this.fieldBoostFactors=[2,1,1,1,2],this.termFilter=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},this.add=function(t){var a=t.getId(),r=!0;if(n.recipesMap.has(a)&&JSON.stringify(n.recipesMap.get(a))===JSON.stringify(t)&&(r=!1),r){n.delete(a);var i=n.recipesMap.set(a,t);return Object(Ne.a)(n.index,n.fieldAccessors,J.words,n.termFilter,a,t),new e(n.index,i)}return n},this.addAll=function(e){return e.reduce((function(e,t){return e.add(t)}),n)},this.search=function(e){return Object(Ce.a)(n.index,n.fieldBoostFactors,1.2,.75,J.words,n.termFilter,void 0,e).reduce((function(e,t){var a=n.recipesMap.get(t.key);return a&&e.push({key:a,score:t.score}),e}),[])},this.all=function(){return Array.from(n.recipesMap.values())},this.get=function(e){return n.recipesMap.get(e)},this.delete=function(t){if(n.recipesMap.has(t)){var a=n.recipesMap.delete(t);return Object(Ne.d)(n.index,new Set,t),new e(n.index,a)}return n},this.getAll=function(e){return e.reduce((function(e,t){var a=n.recipesMap.get(t);return a&&e.push(a),e}),[])},this.count=function(){return n.recipesMap.size},this.index=t||Object(Ne.b)(3),this.recipesMap=a||Object(Oe.b)({})};je.new=function(){return new je},function(e){e[e.MinimalNrIngrediants=1]="MinimalNrIngrediants",e[e.MaximalResueOfIngredients=2]="MaximalResueOfIngredients"}(xe||(xe={}));var Re=function(){function e(){Object(o.a)(this,e),this.nrRecipes=void 0,this.optimization=void 0,this.nrRecipes=5,this.optimization=j.all()[0]}return Object(c.a)(e,[{key:"clone",value:function(){return Object.create(this)}}]),e}(),Me=function(){function e(t){Object(o.a)(this,e),this.buckets=Object(Oe.a)(),this.buckets=t}return Object(c.a)(e,[{key:"setNrBuckets",value:function(t){return new e(this.buckets.setSize(t))}},{key:"getNrBuckets",value:function(){return this.buckets.size}},{key:"getNrRecipes",value:function(){var e,t=0,a=Object(x.a)(this.buckets);try{for(a.s();!(e=a.n()).done;){var n=e.value;n&&(t+=n.count())}}catch(r){a.e(r)}finally{a.f()}return t}},{key:"addRecipeId",value:function(t,a){var n,r=null!==(n=this.buckets.get(t))&&void 0!==n?n:Object(Oe.c)();return new e(this.buckets.set(t,r.add(a)))}},{key:"deleteRecipeId",value:function(t,a){var n,r=null!==(n=this.buckets.get(t))&&void 0!==n?n:Object(Oe.c)();return new e(this.buckets.set(t,r.delete(a)))}},{key:"getRecipeIds",value:function(e){var t,a=null!==(t=this.buckets.get(e))&&void 0!==t?t:Object(Oe.c)();return Array.from(a)}},{key:"getAllRecipeIds",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e){var t,a=Object(Oe.c)(),n=Object(x.a)(this.buckets);try{for(n.s();!(t=n.n()).done;){var r=t.value;r&&(a=a.concat(r))}}catch(s){n.e(s)}finally{n.f()}return Array.from(a)}var i,l=Object(Oe.a)(),o=Object(x.a)(this.buckets);try{for(o.s();!(i=o.n()).done;){var c=i.value;c&&(l=l.concat(c))}}catch(s){o.e(s)}finally{o.f()}return Array.from(l)}}]),e}();Me.new=function(e){return new Me(Object(Oe.a)().setSize(e))};var Le=a(173),Fe=a(174),Te=a(175),De=a(176),Ae=function(e){var t=e.onLoadFile,a=e.onNewRecipe,n=e.onSaveFile,i=e.onEditSettings,l=e.unsavedChanges;return r.a.createElement(m.a,{className:"pl-0 ml-2 mr-2 p-0"},r.a.createElement(d.a,{className:"mb-4"},r.a.createElement(p.a,{className:"pr-0"},r.a.createElement(Q.a,{key:"upload",placement:"right",overlay:r.a.createElement(Le.a,{id:"tooltip-upload"},"Load recipes")},r.a.createElement(Fe.a,{className:"my-first-step-a",style:{color:"#ffffff",cursor:"pointer"},onClick:t})))),r.a.createElement(d.a,{className:"mb-4"},r.a.createElement(p.a,{className:"pr-0"},r.a.createElement(Q.a,{key:"download",placement:"right",overlay:r.a.createElement(Le.a,{id:"tooltip-download"},"Save recipes")},l?r.a.createElement(Te.a,{className:"text-warning",style:{cursor:"pointer"},onClick:n}):r.a.createElement(Te.a,{style:{color:"#ffffff40"}})))),r.a.createElement(d.a,{className:"mb-4"},r.a.createElement(p.a,{className:"pr-0"},r.a.createElement(Q.a,{key:"new",placement:"right",overlay:r.a.createElement(Le.a,{id:"tooltip-new"},"Add new recipe")},r.a.createElement(De.a,{className:"my-first-step-b",style:{color:"#ffffff",cursor:"pointer"},onClick:a})))),r.a.createElement(d.a,{className:"mb-4"},r.a.createElement(p.a,{className:"pr-0"},r.a.createElement(Q.a,{key:"new",placement:"right",overlay:r.a.createElement(Le.a,{id:"tooltip-new"},"Plan settings")},r.a.createElement(te.a,{style:{color:"#ffffff",cursor:"pointer"},onClick:i})))))},Be=a(181),Pe=a(185);var ze,_e=function(){return r.a.createElement(Be.a,{bg:"mealee-menu",variant:"dark",className:"pl-1"},r.a.createElement(Be.a.Brand,{className:"logo",href:"#home"},"Mealee"),r.a.createElement(Be.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(Be.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(Pe.a,{className:"container-fluid"},r.a.createElement(Pe.a.Item,{className:"ml-auto"},r.a.createElement(Pe.a.Link,null,"v","".concat("0.3.2"))))))},He=a(108),Je=a(53);a(149);!function(e){e[e.LoadFile=0]="LoadFile",e[e.SaveFile=1]="SaveFile",e[e.RecipeEditor=2]="RecipeEditor",e[e.SavePlanXLS=3]="SavePlanXLS",e[e.ShoppingList=4]="ShoppingList",e[e.PlanSettings=5]="PlanSettings"}(ze||(ze={}));var Ue=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).renderDialog=K,n.renderInitialBody=Se,n.renderDesktopBody=ke,n.renderMobileBody=we,n.addRecipes=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.setState((function(a){var n=a.unsavedChanges||!(t&&0===a.recipeIndex.count()),r={},i=a.recipeIndex.addAll(e);return i!==a.recipeIndex&&(r={recipeIndex:i,unsavedChanges:n}),r}))},n.setIsInitialTour=function(e){n.setState({isInitialTour:e})},n.saveRecipe=function(e){n.addRecipes([e]),n.closeRecipeEditor()},n.onFileLoaded=function(e){var t,a=null===(t=e.target)||void 0===t?void 0:t.result;if("string"==typeof a)try{n.addRecipes(function(e){var t=JSON.parse(e);if(Array.isArray(t))return t.map(F.fromJSON);if("object"===typeof t){var a=t;if("undefined"!==typeof a.version){if(1!==a.version)throw new Error("Invalid recipe file version");if(Array.isArray(a.recipes))return a.recipes.map(F.fromJSON)}}throw new Error("Invalid recipe file")}(a),!0)}catch(r){n.setState({error:r.message})}n.closeDialog()},n.loadFile=function(e){var t=new FileReader;t.onload=function(e){return n.onFileLoaded(e)},t.readAsText(e,"UTF-8")},n.genRecipeFileContent=function(){return function(e){var t=JSON.stringify({version:1,recipes:e}),a=(new TextEncoder).encode(t);return new Blob([a],{type:"application/json;charset=utf-8"})}(n.state.recipeIndex.all())},n.fileSaved=function(){n.setState({unsavedChanges:!1}),n.closeDialog()},n.showDialog=function(e){return function(){return n.setState({showDialog:e})}},n.closeDialog=function(){n.setState({showDialog:void 0})},n.closeRecipeEditor=function(){n.setState({recipeToEdit:void 0,showDialog:void 0})},n.dismissError=function(){n.setState({error:null})},n.updatePlanSettings=function(e){n.setState((function(t){return{planSettings:e,plan2:t.plan2.setNrBuckets(e.nrRecipes)}}))},n.updatePlan=function(e){n.setState({plan2:e})},n.editRecipe=function(e){n.setState({showDialog:ze.RecipeEditor,recipeToEdit:e})},n.deleteRecipe=function(e){n.setState((function(t){return{recipeIndex:t.recipeIndex.delete(e.getId()),showDialog:void 0,recipeToEdit:void 0,unsavedChanges:!0}}))};var r=new je,i=new Re;return n.state={recipeIndex:r,planSettings:i,plan2:Me.new(i.nrRecipes),showDialog:void 0,recipeToEdit:void 0,error:null,unsavedChanges:!1,isInitialTour:!1},n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(m.a,{fluid:!0,className:"d-flex flex-column vh-100"},r.a.createElement(f.a,{variant:"danger",onClose:this.dismissError,show:!!this.state.error,dismissible:!0},this.state.error),this.state.unsavedChanges&&r.a.createElement(He.a,{onBeforeunload:function(){return"You'll lose your data!"}}),this.renderDialog(),r.a.createElement(d.a,null,r.a.createElement(p.a,null,r.a.createElement(_e,null))),r.a.createElement(d.a,{className:"h-100",style:{minHeight:0}},r.a.createElement(p.a,{xs:"auto",className:"pl-0 pr-2 pt-3"},r.a.createElement(Ae,{onLoadFile:this.showDialog(ze.LoadFile),onNewRecipe:this.showDialog(ze.RecipeEditor),onSaveFile:this.showDialog(ze.SaveFile),onEditSettings:this.showDialog(ze.PlanSettings),unsavedChanges:this.state.unsavedChanges})),0===this.state.recipeIndex.count()&&this.renderInitialBody(),this.state.recipeIndex.count()>0&&!Je.isMobileOnly&&this.renderDesktopBody(),this.state.recipeIndex.count()>0&&Je.isMobileOnly&&this.renderMobileBody()))}}]),a}(r.a.Component),Ge=a(177),Xe=a(105),We=a(106);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ge.a,{backend:Je.isMobile?We.a:Xe.a},r.a.createElement(Ue,null))),document.getElementById("root"))},82:function(e,t){}},[[116,1,2]]]);
//# sourceMappingURL=main.40d9e16b.chunk.js.map