(this.webpackJsonpmealee=this.webpackJsonpmealee||[]).push([[0],{70:function(e,t){},81:function(e,t,n){e.exports=n(99)},82:function(e,t,n){},96:function(e,t){},97:function(e,t){},99:function(e,t,n){"use strict";n.r(t);n(82);var a=n(0),r=n.n(a),i=n(15),l=n.n(i),o=n(10),c=n(24),s=n(80),u=n(78),m=n(116),p=n(109),d=n(113),f=n(72),v=n(106),g=n(104),h=n(105),E=n(71),y=n(111),b=n(112),S=n(110),x=function(){function e(t,n,a){Object(o.a)(this,e),this.name=void 0,this.amount=void 0,this.unit=void 0,this.name=t,this.amount=n,this.unit=a}return Object(c.a)(e,[{key:"getName",value:function(){return this.name}},{key:"getAmount",value:function(){return this.amount}},{key:"getUnit",value:function(){return this.unit}},{key:"toJSON",value:function(){return{name:this.name,amount:this.amount,unit:this.unit}}}],[{key:"fromJSON",value:function(t){if(!t.name)throw new Error("Missing ingredient name");if(!t.unit)throw new Error("Missing ingredient unit");if(void 0===t.amount)throw new Error("Missing ingredient amount");return new e(t.name,t.amount,t.unit)}}]),e}();var I=function(){function e(t,n){Object(o.a)(this,e),this.id=void 0,this.title=void 0,this.summary=void 0,this.source=void 0,this.sourceUrl=void 0,this.readyInMinutes=void 0,this.ingredients=void 0,this.id=t,this.title=n,this.ingredients=[]}return Object(c.a)(e,[{key:"getId",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getSummary",value:function(){return this.summary}},{key:"getSource",value:function(){return this.source}},{key:"getReadyInMinutes",value:function(){return this.readyInMinutes}},{key:"getIngredients",value:function(){return this.ingredients}},{key:"toJSON",value:function(){return{id:this.id,title:this.title,summary:this.summary,source:this.source,readyInMinutes:this.readyInMinutes,ingredients:this.ingredients.map((function(e){return e.toJSON()}))}}}],[{key:"fromJSON",value:function(t){if(t.id||(t.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))),!t.title)throw new Error("Missing recipe title");var n=new e(t.id,t.title);return n.summary=t.summary,n.source=t.source,n.readyInMinutes=t.readyInMinutes,Array.isArray(t.ingredients)&&(n.ingredients=t.ingredients.map((function(e){return x.fromJSON(e)}))),n}}]),e}();var w=n(11),O=n(118),k=n(107),R=n(73),C=n(117),j=n(114),N=function(e){var t=e.recipeIndex,n=e.selectedRecipes,a=e.maxNrSelected,i=e.onUpdate,l=e.onEdit,o=r.a.useState(""),c=Object(w.a)(o,2),s=c[0],u=c[1],m=r.a.useState(null),p=Object(w.a)(m,2),d=p[0],y=p[1],S=0===s.trim().length?t.all():t.search(s).map((function(e){return e.key})),x=new Map(n.map((function(e){return[e.getId(),e]}))),I=function(e){var t=e.getSummary()?e.getSummary():"Summary is not available",n=e.getIngredients().map((function(e){return e.getName()})).sort().map((function(e){return r.a.createElement(E.a,{sm:"auto",className:"border mt-1 ml-2 pt-2 pb-2"},e)}));return r.a.createElement(C.a,{id:"popover-basic"},r.a.createElement(C.a.Title,{as:"h4"},e.getTitle()),r.a.createElement(C.a.Content,null,r.a.createElement(g.a,{className:"pl-0 pr-0"},r.a.createElement(h.a,{className:"pb-2"},r.a.createElement(E.a,null,t)),r.a.createElement(h.a,{className:"pb-2"},r.a.createElement(E.a,{sm:"auto"},r.a.createElement(v.a,{src:"clock20x20.jpg"})),r.a.createElement(E.a,{sm:"auto"},e.getReadyInMinutes()?e.getReadyInMinutes()+" mintes":"unknown"),r.a.createElement(E.a,{sm:"auto"},r.a.createElement(v.a,{src:"babyowl17x20.jpg"})),r.a.createElement(E.a,{sm:"auto"},e.getSource()?e.getSource():"-")),r.a.createElement(h.a,null,n))))},N=S.map((function(e){return r.a.createElement(j.a,{placement:"right",overlay:I(e),onEnter:function(){return y(e.getId())},onExit:function(){return y(null)},key:e.getId()},r.a.createElement(O.a.Item,{key:e.getId()},r.a.createElement(b.a.Check,{type:"checkbox",id:e.getId(),label:e.getTitle(),disabled:!x.has(e.getId())&&x.size>=a,checked:x.has(e.getId()),onChange:function(){return t=e,x.has(t.getId())?x.delete(t.getId()):x.set(t.getId(),t),void i(Array.from(x.values()));var t}}),function(e){return d===e.getId()?r.a.createElement(f.a,{variant:"outline-primary",size:"sm",className:"mt-2",onClick:function(t){return l(e)}},"Edit"):""}(e)))}));return r.a.createElement(b.a,{className:"pt-2",onSubmit:function(e){return e.preventDefault()}},r.a.createElement(k.a,{className:"mb-2"},r.a.createElement(k.a.Prepend,null,r.a.createElement(k.a.Text,{id:"basic-addon1"},"@")),r.a.createElement(R.a,{type:"text",placeholder:"Filter recipes",onChange:function(e){u(e.currentTarget.value)}})),r.a.createElement(b.a.Group,{controlId:"recipeGroup"},r.a.createElement(O.a,null,N)))},M=n(36),F=n(75),T=n(66),D=n(74),A=function e(t,n){var a=this;Object(o.a)(this,e),this.recipesMap=void 0,this.index=void 0,this.fieldAccessors=[function(e){return e.getTitle()},function(e){var t;return null!==(t=e.getSummary())&&void 0!==t?t:""},function(e){return e.getIngredients().map((function(e){return e.getName()})).join(" ")}],this.fieldBoostFactors=[2,.5,1],this.termFilter=function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},this.add=function(t){var n=t.getId(),r=!0;if(a.recipesMap.has(n)&&JSON.stringify(a.recipesMap.get(n))===JSON.stringify(t)&&(r=!1),r){a.delete(n);var i=a.recipesMap.set(n,t);return Object(M.a)(a.index,a.fieldAccessors,T.words,a.termFilter,n,t),new e(a.index,i)}return a},this.addAll=function(e){return e.reduce((function(e,t){return e.add(t)}),a)},this.search=function(e){return Object(F.a)(a.index,a.fieldBoostFactors,1.2,.75,T.words,a.termFilter,void 0,e).reduce((function(e,t){var n=a.recipesMap.get(t.key);return n&&e.push({key:n,score:t.score}),e}),[])},this.all=function(){return Array.from(a.recipesMap.values())},this.get=function(e){return a.recipesMap.get(e)},this.delete=function(t){if(a.recipesMap.has(t)){var n=a.recipesMap.delete(t);return Object(M.d)(a.index,new Set,t),new e(a.index,n)}return a},this.getAll=function(e){return e.reduce((function(e,t){var n=a.recipesMap.get(t);return n&&e.push(n),e}),[])},this.count=function(){return a.recipesMap.size},this.index=t||Object(M.b)(3),this.recipesMap=n||Object(D.a)({})};A.new=function(){return new A};var L=function(e){var t=e.title,n=e.loadButtonTitle,a=e.onClose,i=e.onLoad,l=r.a.useState(null),o=Object(w.a)(l,2),c=o[0],s=o[1];return r.a.createElement(y.a,{show:!0,onHide:a},r.a.createElement(y.a.Header,{closeButton:!0},r.a.createElement(y.a.Title,null,t)),r.a.createElement(y.a.Body,null,r.a.createElement(b.a,null,r.a.createElement(R.a,{type:"file",onChange:function(e){e.target.files?s(e.target.files[0]):s(null)}}))),r.a.createElement(y.a.Footer,null,r.a.createElement(f.a,{type:"button",variant:"secondary",onClick:a},"Close"),r.a.createElement(f.a,{type:"button",variant:"primary",disabled:!c,onClick:function(){c&&i(c)}},n)))},B=n(76),J=n.n(B),_=function(e){var t=e.title,n=e.saveButtonTitle,a=e.onClose,i=e.onSave,l=e.data,o=e.type,c=e.initialFileName,s=e.extension,u=r.a.useState(c),m=Object(w.a)(u,2),p=m[0],d=m[1];return r.a.createElement(y.a,{show:!0,onHide:a},r.a.createElement(y.a.Header,{closeButton:!0},r.a.createElement(y.a.Title,null,t)),r.a.createElement(y.a.Body,null,r.a.createElement(b.a,null,r.a.createElement(b.a.Group,{controlId:"formBasicFileName"},r.a.createElement(b.a.Label,null,"File name"),r.a.createElement(b.a.Control,{type:"fileName",value:p,onChange:function(e){return d(e.target.value)}})))),r.a.createElement(y.a.Footer,null,r.a.createElement(f.a,{type:"button",variant:"secondary",onClick:a},"Close"),r.a.createElement(f.a,{type:"button",variant:"primary",disabled:!p||0===p.length,onClick:function(){J()(l,p+"."+s,o),i()}},n)))},z=n(115),G=n(119);var U=n(18);var H=function e(){Object(o.a)(this,e),this.name="Minimal number of ingredients",this.id="miningredients",this.filter=function(e,t,n){var a=new Set(e.concat(t).flatMap((function(e){return e.getIngredients().map((function(e){return e.getName()}))}))),r=n.map((function(e){return{recipe:e,score:(t=a,n=e,n.getIngredients().reduce((function(e,n){return t.has(n.getName())?e:e+1}),0))};var t,n})).sort((function(e,t){return e.score<t.score?-1:e.score>t.score?1:0})),i=[];if(r.length>0){var l,o=Object(U.a)(r);try{for(o.s();!(l=o.n()).done;){var c=l.value;if(r[0].score!==c.score)break;i.push(c.recipe)}}catch(s){o.e(s)}finally{o.f()}}return i}};var P=function e(){Object(o.a)(this,e),this.name="Maximal reuse of ingredients",this.id="maxreuse",this.filter=function(e,t,n){var a=new Set(e.concat(t).flatMap((function(e){return e.getIngredients().map((function(e){return e.getName()}))}))),r=n.map((function(e){return{recipe:e,score:(t=a,n=e,n.getIngredients().reduce((function(e,n){return t.has(n.getName())?e+1:e}),0))};var t,n})).sort((function(e,t){return e.score<t.score?1:e.score>t.score?-1:0})),i=[];if(r.length>0){var l,o=Object(U.a)(r);try{for(o.s();!(l=o.n()).done;){var c=l.value;if(r[0].score!==c.score)break;i.push(c.recipe)}}catch(s){o.e(s)}finally{o.f()}}return i}},X=new function e(){Object(o.a)(this,e),this.name="Random filter",this.id="rnd",this.filter=function(e,t,n){return 0===n.length?[]:[n[(a=n.length,Math.floor(Math.random()*Math.floor(a)))]];var a}};var K,q=function(){var e=[new H,new P,X],t=new Map(e.map((function(e){return[e.id,e]})));return{all:function(){return e},get:function(e){return t.get(e)}}}(),W=function(e){var t=r.a.useState(!0),n=Object(w.a)(t,2),a=n[0],i=n[1],l=q.all().map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}));return r.a.createElement(z.a,{defaultActiveKey:"0"},r.a.createElement(G.a,null,r.a.createElement(z.a.Toggle,{as:G.a.Header,variant:"link",eventKey:"1",onClick:function(){return i(!a)}},"Plan settings ",a?"[+]":"[-]"),r.a.createElement(z.a.Collapse,{eventKey:"1"},r.a.createElement(G.a.Body,null,r.a.createElement(b.a,{onSubmit:function(e){return e.preventDefault()}},r.a.createElement(b.a.Group,{controlId:"nrRecipes"},r.a.createElement(b.a.Label,null,"Number of recipes:"),r.a.createElement(b.a.Control,{as:"select",value:e.planSettings.nrRecipes,onChange:function(t){return function(t){var n=e.planSettings.clone();n.nrRecipes=t,e.onUpdate(n)}(parseInt(t.target.value))}},r.a.createElement("option",{key:"3"},"3"),r.a.createElement("option",{key:"4"},"4"),r.a.createElement("option",{key:"5"},"5"),r.a.createElement("option",{key:"6"},"6"),r.a.createElement("option",{key:"7"},"7"))),r.a.createElement(b.a.Group,{controlId:"optimization"},r.a.createElement(b.a.Label,null,"Optimize by:"),r.a.createElement(b.a.Control,{as:"select",value:e.planSettings.optimization.id,onChange:function(t){return function(t){var n=q.get(t);if(n){var a=e.planSettings.clone();a.optimization=n,e.onUpdate(a)}}(t.target.value)}},l)))))))};!function(e){e[e.MinimalNrIngrediants=1]="MinimalNrIngrediants",e[e.MaximalResueOfIngredients=2]="MaximalResueOfIngredients"}(K||(K={}));var Y=function(){function e(){Object(o.a)(this,e),this.nrRecipes=void 0,this.optimization=void 0,this.nrRecipes=5,this.optimization=q.all()[0]}return Object(c.a)(e,[{key:"clone",value:function(){return Object.create(this)}}]),e}(),$=n(108),Q=n(27),V=n.n(Q);function Z(e){var t=new Map;return e.forEach((function(e){e.getIngredients().forEach((function(n){var a=t.get(n.getName());a||(a=new Map,t.set(n.getName(),a)),a.set(e.getId(),[n.getAmount(),n.getUnit()])}))})),t}function ee(e,t){var n,a=t.map((function(t){var n,a,r=new Map,i=null!==(n=e.get(t))&&void 0!==n?n:new Map,l=Object(U.a)(i.values());try{for(l.s();!(a=l.n()).done;){var o,c=Object(w.a)(a.value,2),s=c[0],u=c[1];r.set(u,(null!==(o=r.get(u))&&void 0!==o?o:0)+s)}}catch(m){l.e(m)}finally{l.f()}return{name:t,amounts:r}})),r=[],i=Object(U.a)(a);try{for(i.s();!(n=i.n()).done;){var l,o=n.value,c=o.name,s=o.amounts,u=[c],m=Object(U.a)(s);try{for(m.s();!(l=m.n()).done;){var p=Object(w.a)(l.value,2),d=p[0],f=p[1];u.push(f+" "+d)}}catch(v){m.e(v)}finally{m.f()}r.push(u)}}catch(v){i.e(v)}finally{i.f()}return r}function te(e){var t,n=Z(e.allRecipes()),a=Array.from(n.keys()).sort(),r=ee(n,a),i="",l=Object(U.a)(r);try{for(l.s();!(t=l.n()).done;){var o=t.value;i+="**"+o.shift()+"**",i+=" - ",i+=o.join(" + "),i+="\n"}}catch(c){l.e(c)}finally{l.f()}return i}function ne(e){var t=e.allRecipes(),n=Z(t),a=Array.from(n.keys()).sort(),r=V.a.utils.book_new(),i=ee(n,a),l=V.a.utils.aoa_to_sheet(i);V.a.utils.book_append_sheet(r,l,"Shopping list");var o=t.map((function(e){return e.getTitle()}));o.unshift("");var c=a.map((function(e){var a,r=[e],i=Object(U.a)(t);try{for(i.s();!(a=i.n()).done;){var l,o=a.value,c=(null!==(l=n.get(e))&&void 0!==l?l:new Map).get(o.getId());c?r.push(c[0]+" "+c[1]):r.push("")}}catch(s){i.e(s)}finally{i.f()}return r})),s=[o].concat(c),u=V.a.utils.aoa_to_sheet(s);V.a.utils.book_append_sheet(r,u,"Plan");var m,p=Object(U.a)(t);try{for(p.s();!(m=p.n()).done;){var d,f,v,g,h=m.value,E=[["Title",h.getTitle()],["Summary",null!==(d=h.getSummary())&&void 0!==d?d:"-"],["Ready in minutes",null!==(f=h.getReadyInMinutes())&&void 0!==f?f:"-"],["Source",null!==(v=h.getSource())&&void 0!==v?v:"-"],["Ingredients:"]],y=Object(U.a)(h.getIngredients());try{for(y.s();!(g=y.n()).done;){var b=g.value;E.push([b.getName(),b.getAmount(),b.getUnit()])}}catch(I){y.e(I)}finally{y.f()}var S=V.a.utils.aoa_to_sheet(E);V.a.utils.book_append_sheet(r,S,h.getTitle())}}catch(I){p.e(I)}finally{p.f()}var x=V.a.write(r,{bookType:"xlsx",bookSST:!1,type:"array"});return new Blob([x],{type:"application/octet-stream"})}var ae=function(e){var t=e.plan,n=t.allRecipes(),a=t.explicitRecipes.map((function(e){return r.a.createElement("th",null,e.getTitle())})),i=t.calculatedRecipes.map((function(e){return r.a.createElement("th",{className:"bg-light"},e.getTitle())})),l=Z(n),o=Array.from(l.keys()).sort().map((function(e){var t=n.map((function(t){var n,a=(null!==(n=l.get(e))&&void 0!==n?n:new Map).get(t.getId());return a?r.a.createElement("td",null,a[0]+" "+a[1]):r.a.createElement("td",null,"\xa0")}));return r.a.createElement("tr",null,r.a.createElement("th",null,e),t)}));return r.a.createElement(g.a,{className:"pt-0 pb-0 pl-0 pr-0"},r.a.createElement($.a,{striped:!0,bordered:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),a,i)),r.a.createElement("tbody",null,o)))},re=n(14),ie=n(77),le=n.n(ie),oe=function(e){var t=r.a.useState(e.recipe?e.recipe.toJSON():Object.create({})),n=Object(w.a)(t,2),a=n[0],i=n[1],l=r.a.useState(!e.recipe),o=Object(w.a)(l,2),c=o[0],s=o[1],u=r.a.useState(!1),m=Object(w.a)(u,2),p=m[0],d=m[1],v=r.a.useState(e.recipe?e.recipe.getIngredients().map((function(e){return e.getName()+";"+e.getAmount()+";"+e.getUnit()})).join("\n"):""),g=Object(w.a)(v,2),h=g[0],E=g[1],S=new le.a({autocompleteMode:!0,values:[{key:"Phil Heartman",value:"pheartman"},{key:"Gordon Ramsey",value:"gramsey"}]}),x=function(e){R.current&&(console.log(e.selectionStart),console.log(e.value.charAt(e.selectionStart)),0===e.selectionStart&&(S.attach(R.current),S.showMenuForCollection(R.current)))},O=function(){e.recipe&&e.onDelete(e.recipe)},k=r.a.createRef(),R=r.a.createRef();return r.a.createElement(y.a,{show:!0,onHide:e.onClose,onEntered:function(){k.current&&k.current.focus()}},r.a.createElement(y.a.Header,{closeButton:!0},r.a.createElement(y.a.Title,null,"Add new recipe")),r.a.createElement(y.a.Body,null,r.a.createElement(b.a,null,r.a.createElement(b.a.Group,{controlId:"formTitle"},r.a.createElement(b.a.Control,{type:"title",value:a.title,placeholder:"Title",isInvalid:c,onChange:function(e){var t=e.currentTarget.value;s(!t||0===t.length),i((function(e){return Object(re.a)(Object(re.a)({},e),{title:t})}))},ref:k}),r.a.createElement(b.a.Control.Feedback,{type:"invalid"},"Required field!")),r.a.createElement(b.a.Group,{controlId:"formSummary"},r.a.createElement(b.a.Control,{as:"textarea",value:a.summary,onChange:function(e){var t=e.currentTarget.value;i((function(e){return Object(re.a)(Object(re.a)({},e),{summary:t})}))},rows:4,placeholder:"Summary"})),r.a.createElement(b.a.Group,{controlId:"formSource"},r.a.createElement(b.a.Control,{type:"source",value:a.source,onChange:function(e){var t=e.currentTarget.value;i((function(e){return Object(re.a)(Object(re.a)({},e),{source:t})}))},placeholder:"Where to find the recipe"})),r.a.createElement(b.a.Group,{controlId:"formMinutes"},r.a.createElement(b.a.Control,{type:"minutes",value:a.readyInMinutes,onChange:function(e){var t=Number.parseInt(e.currentTarget.value);isNaN(t)&&(t=void 0),i((function(e){return Object(re.a)(Object(re.a)({},e),{readyInMinutes:t})}))},placeholder:"Number of minutes to cook"})),r.a.createElement(b.a.Group,{controlId:"formIngredients"},r.a.createElement(b.a.Control,{as:"textarea",value:h,rows:8,onFocus:function(e){e.preventDefault(),x(e.target)},onChange:function(e){E(e.currentTarget.value);var t=e.currentTarget.value.split(/\r?\n/);if(0===t.length)i((function(e){return Object(re.a)(Object(re.a)({},e),{ingredients:[]})}));else{var n=[],a=!1;t.forEach((function(e){if(e.length>0){var t=e.split(";").map((function(e){return e.trim()}));3!==t.length||0===t[0].length||0===t[1].length||0===t[2].length||""+Number.parseInt(t[1])!==t[1]?a=!0:n.push({name:t[0],amount:Number.parseInt(t[1]),unit:t[2]})}})),a?d(!0):(d(!1),i((function(e){return Object(re.a)(Object(re.a)({},e),{ingredients:n})})))}x(e.target)},isInvalid:p,placeholder:"Ingredients: <name>;<amount>;<unit>",ref:R}),r.a.createElement(b.a.Control.Feedback,{type:"invalid"},"Format must be ","<","name",">",";","<","amount",">",";","<","unit",">",' for every line!"')))),r.a.createElement(y.a.Footer,null,r.a.createElement(f.a,{type:"button",variant:"secondary",onClick:e.onClose},"Close"),r.a.createElement(f.a,{type:"button",variant:"primary",onClick:function(){e.onSave(I.fromJSON(a))},disabled:c||p},"Save recipe"),function(){if(e.recipe)return r.a.createElement(f.a,{type:"button",variant:"primary",onClick:O},"Delete recipe")}()))},ce=function(){function e(){Object(o.a)(this,e),this.explicitRecipes=void 0,this.calculatedRecipes=void 0,this.explicitRecipes=[],this.calculatedRecipes=[]}return Object(c.a)(e,[{key:"allRecipes",value:function(){return this.explicitRecipes.concat(this.calculatedRecipes)}},{key:"nrRecipes",value:function(){return this.explicitRecipes.length+this.calculatedRecipes.length}},{key:"clone",value:function(){return Object.create(this)}}]),e}();function se(e,t,n){var a=Math.max(0,n.nrRecipes-t.explicitRecipes.length),r=new Set(e.all().map((function(e){return e.getId()}))),i=new Set(r);t.explicitRecipes.forEach((function(e){return i.delete(e.getId())}));for(var l=[],o=0;o<a;o++){var c=e.getAll(Array.from(i)),s=n.optimization.filter(t.explicitRecipes,l,c);if(s.length>0){var u=X.filter(t.explicitRecipes,l,s)[0];l.push(u),i.delete(u.getId())}}var m=t.clone();return m.calculatedRecipes=l,m}var ue=n(79);n(98);var me,pe=function(e){var t=e.onLoadFile,n=e.onNewRecipe,a=e.onSaveFile,i=e.unsavedChanges;return r.a.createElement(m.a,{bg:"dark",variant:"dark"},r.a.createElement(m.a.Brand,{href:"#home"},"Mealee"),r.a.createElement(m.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(m.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(p.a,{className:"container-fluid"},r.a.createElement(d.a,{title:"Recipes",id:"collasible-nav-dropdown"},r.a.createElement(d.a.Item,{href:"#",active:!1,onClick:t},"Load recipes..."),r.a.createElement(d.a.Item,{href:"#",active:!1,onClick:a,disabled:!i},"Save recipes..."),r.a.createElement(d.a.Divider,null),r.a.createElement(d.a.Item,{href:"#",active:!1,onClick:n},"Add new recipe...")),r.a.createElement(p.a.Item,{className:"ml-auto"},r.a.createElement(p.a.Link,null,"v","".concat("0.1.2"))))),"$","0.1.2")};!function(e){e[e.LoadFile=0]="LoadFile",e[e.SaveFile=1]="SaveFile",e[e.RecipeEditor=2]="RecipeEditor",e[e.SavePlanXLS=3]="SavePlanXLS",e[e.ShoppingList=4]="ShoppingList"}(me||(me={}));var de=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).addRecipes=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.setState((function(n){var a=n.unsavedChanges||!(t&&0===n.recipeIndex.count()),r={},i=n.recipeIndex.addAll(e);return i!==n.recipeIndex&&(r={recipeIndex:i,plan:se(i,n.plan,n.planSettings),unsavedChanges:a}),r}))},a.saveRecipe=function(e){a.addRecipes([e]),a.closeRecipeEditor()},a.onFileLoaded=function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.result;if("string"==typeof n)try{a.addRecipes(function(e){var t=JSON.parse(e);if(Array.isArray(t))return t.map(I.fromJSON);if("object"===typeof t){var n=t;if("undefined"!==typeof n.version){if(1!==n.version)throw new Error("Invalid recipe file version");if(Array.isArray(n.recipes))return n.recipes.map(I.fromJSON)}}throw new Error("Invalid recipe file")}(n),!0)}catch(r){a.setState({error:r.message})}a.closeDialog()},a.loadFile=function(e){var t=new FileReader;t.onload=function(e){return a.onFileLoaded(e)},t.readAsText(e,"UTF-8")},a.genRecipeFileContent=function(){return function(e){var t=JSON.stringify({version:1,recipes:e}),n=(new TextEncoder).encode(t);return new Blob([n],{type:"application/json;charset=utf-8"})}(a.state.recipeIndex.all())},a.fileSaved=function(){a.setState({unsavedChanges:!1}),a.closeDialog()},a.showDialog=function(e){return function(){return a.setState({showDialog:e})}},a.closeDialog=function(){a.setState({showDialog:void 0})},a.closeRecipeEditor=function(){a.setState({recipeToEdit:void 0,showDialog:void 0})},a.dismissError=function(){a.setState({error:null})},a.updatePlanSettings=function(e){a.setState((function(t){return{planSettings:e,plan:se(t.recipeIndex,t.plan,e)}}))},a.updateExplicitRecipes=function(e){a.setState((function(t){var n=Object.create(t.plan);return n.explicitRecipes=e,{plan:se(t.recipeIndex,n,t.planSettings)}}))},a.editRecipe=function(e){a.setState({showDialog:me.RecipeEditor,recipeToEdit:e})},a.deleteRecipe=function(e){a.setState((function(t){var n=t.recipeIndex.delete(e.getId());return{recipeIndex:n,plan:se(n,t.plan,t.planSettings),showDialog:void 0,recipeToEdit:void 0,unsavedChanges:!0}}))},a.renderDialog=function(){switch(a.state.showDialog){case me.LoadFile:return r.a.createElement(L,{onClose:a.closeDialog,title:"Load recipes file",loadButtonTitle:"Load recipes",onLoad:a.loadFile});case me.SaveFile:return r.a.createElement(_,{onClose:a.closeDialog,title:"Save recipes file",saveButtonTitle:"Save recipes",data:a.genRecipeFileContent(),type:"application/json",initialFileName:"recipes",extension:"json",onSave:a.fileSaved});case me.RecipeEditor:return r.a.createElement(oe,{onClose:a.closeRecipeEditor,onSave:a.saveRecipe,onDelete:a.deleteRecipe,recipe:a.state.recipeToEdit});case me.SavePlanXLS:return r.a.createElement(_,{onClose:a.closeDialog,title:"Save plan",saveButtonTitle:"Save plan",data:ne(a.state.plan),type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",initialFileName:"plan",extension:"xlsx",onSave:a.closeDialog});case me.ShoppingList:return r.a.createElement(y.a,{show:!0,onHide:a.closeDialog},r.a.createElement(y.a.Header,{closeButton:!0},r.a.createElement(y.a.Title,null,"Shopping list")),r.a.createElement(y.a.Body,null,r.a.createElement(b.a,null,r.a.createElement(b.a.Control,{as:"textarea",rows:20,cols:80,value:te(a.state.plan),readOnly:!0}))),r.a.createElement(y.a.Footer,null,r.a.createElement(f.a,{variant:"secondary",onClick:a.closeDialog},"Close")));default:return r.a.createElement(r.a.Fragment,null)}};var i=new A,l=new Y;return a.state={recipeIndex:i,planSettings:l,plan:se(i,new ce,l),showDialog:void 0,recipeToEdit:void 0,error:null,unsavedChanges:!1},a}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{fluid:!0,className:"p-3"},r.a.createElement(S.a,{variant:"danger",onClose:this.dismissError,show:!!this.state.error,dismissible:!0},this.state.error),function(){if(e.state.unsavedChanges)return r.a.createElement(ue.a,{onBeforeunload:function(){return"You'll lose your data!"}})}(),this.renderDialog(),r.a.createElement(h.a,null,r.a.createElement(E.a,null,r.a.createElement(pe,{onLoadFile:this.showDialog(me.LoadFile),onNewRecipe:this.showDialog(me.RecipeEditor),onSaveFile:this.showDialog(me.SaveFile),unsavedChanges:this.state.unsavedChanges}))),r.a.createElement(h.a,null,r.a.createElement(E.a,null,r.a.createElement(W,{planSettings:this.state.planSettings,onUpdate:this.updatePlanSettings}))),r.a.createElement(h.a,{className:"pb-2"},r.a.createElement(E.a,{xs:"3"},r.a.createElement(N,{selectedRecipes:this.state.plan.explicitRecipes,recipeIndex:this.state.recipeIndex,maxNrSelected:this.state.planSettings.nrRecipes,onUpdate:this.updateExplicitRecipes,onEdit:this.editRecipe})),r.a.createElement(E.a,null,0===e.state.plan.nrRecipes()?r.a.createElement(g.a,{className:"pt-2 pl-0"},"No recipes are planned"):r.a.createElement(g.a,{className:"pt-2 pl-0 pr-0"},r.a.createElement(h.a,null,r.a.createElement(E.a,null,r.a.createElement(ae,{plan:e.state.plan,planSettings:e.state.planSettings}))),r.a.createElement(h.a,null,r.a.createElement(E.a,null,r.a.createElement(f.a,{className:"float-right",onClick:e.showDialog(me.SavePlanXLS)},"Export plan \xa0",r.a.createElement(v.a,{src:"xlsx_logo.svg",height:"18"})),r.a.createElement(f.a,{className:"float-right mr-2",onClick:e.showDialog(me.ShoppingList)},"Show shopping list \xa0",r.a.createElement(v.a,{src:"todoist_logo.svg",height:"18"}))))))))}}]),n}(r.a.Component);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(de,null)),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.7544839e.chunk.js.map